<!DOCTYPE html>
<html>
<head>
    <style>
        body { margin: 0; display: none; font-family: sans-serif; } /* Скрыт, пока нет задания */
        #box { 
            background: #2c3e50; color: white; padding: 20px; 
            border-radius: 15px; text-align: center; border: 4px solid #3498db;
        }
        .opt { 
            display: block; width: 100%; margin: 10px 0; padding: 10px;
            background: #34495e; color: white; border: none; border-radius: 5px; cursor: pointer;
        }
        .opt:hover { background: #3498db; }
    </style>
</head>
<body>
    <div id="box">
        <h2 id="q">Question?</h2>
        <div id="btns"></div>
    </div>

<script>
    // Тот самый банк заданий (короткая версия для теста)
    const tasks = [
        { lvl: 1, q: "I ___ to school.", opts: ["go", "went", "goed"], a: "went" },
        { lvl: 2, q: "She ___ a cake.", opts: ["make", "made", "maked"], a: "made" }
    ];

    // Слушаем сигнал от Genially
    window.addEventListener("message", (event) => {
        if (event.data.type === "START_TASK") {
            showQuestion(event.data.level);
        }
    });

    function showQuestion(lvl) {
        document.body.style.display = "block";
        const task = tasks.find(t => t.lvl === lvl) || tasks[0];
        document.getElementById('q').innerText = task.q;
        const btns = document.getElementById('btns');
        btns.innerHTML = '';
        
        task.opts.forEach(o => {
            const b = document.createElement('button');
            b.className = 'opt';
            b.innerText = o;
            b.onclick = () => {
                const isCorrect = o === task.a;
                // Отправляем результат обратно в Genially
                window.parent.postMessage({
                    type: "TASK_RESULT",
                    success: isCorrect,
                    verb: task.q
                }, "*");
                document.body.style.display = "none";
            };
            btns.appendChild(b);
        });
    }
</script>
</body>
</html>
