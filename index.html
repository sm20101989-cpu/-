<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>
        body { font-family: sans-serif; background: #202124; color: white; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        #game-ui { background: #3c4043; padding: 20px; border-radius: 12px; text-align: center; border: 2px solid #8ab4f8; width: 90%; display: none; }
        button { background: #8ab4f8; border: none; padding: 10px 20px; margin: 5px; border-radius: 5px; cursor: pointer; font-weight: bold; }
        button:hover { background: #aecbfa; }
    </style>
</head>
<body>
    <div id="game-ui">
        <h3 id="question">Question</h3>
        <div id="options"></div>
    </div>

<script>
    const tasks = [
        { lvl: 1, q: "I ___ to school yesterday.", opts: ["go", "went", "goed"], a: "went" },
        { lvl: 2, q: "She ___ a cake.", opts: ["make", "made", "maked"], a: "made" }
    ];

    // Слушаем сигнал от Genially
    window.addEventListener("message", (event) => {
        // Проверяем, что пришла команда открыть вопрос
        if (event.data.type === "OPEN_TASK") {
            showTask(event.data.level);
        }
    });

    function showTask(lvl) {
        const ui = document.getElementById('game-ui');
        const qEl = document.getElementById('question');
        const optEl = document.getElementById('options');
        
        const task = tasks.find(t => t.lvl === lvl) || tasks[0];
        
        ui.style.display = 'block';
        qEl.innerText = task.q;
        optEl.innerHTML = '';

        task.opts.forEach(o => {
            const btn = document.createElement('button');
            btn.innerText = o;
            btn.onclick = () => {
                const isCorrect = o === task.a;
                // Отправляем результат обратно в Genially
                window.parent.postMessage({
                    type: "ANSWER_RESULT",
                    success: isCorrect
                }, "*");
                ui.style.display = 'none';
            };
            optEl.appendChild(btn);
        });
    }
</script>
</body>
</html>
