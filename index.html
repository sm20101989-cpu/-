<!DOCTYPE html>
<html lang="en"><!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>Maze of Verbs ‚Äî Hedge</title>
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Nunito:wght@600;700;800;900&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
html,body{width:100%;height:100%;overflow:hidden;background:#0a1a04;font-family:'Nunito',sans-serif;user-select:none;-webkit-user-select:none}
#G{position:relative;width:100%;height:100%}
canvas{display:block;position:absolute;inset:0;width:100%;height:100%;cursor:pointer}
#hud{position:absolute;top:0;left:0;right:0;height:66px;display:flex;align-items:center;gap:8px;padding:6px 12px;z-index:50;pointer-events:none;background:linear-gradient(180deg,rgba(0,20,0,.85)0%,transparent)}
.av{width:54px;height:54px;border:3px solid #7ec850;border-radius:50%;background:radial-gradient(#2a5a10,#0a1e04);display:flex;align-items:center;justify-content:center;font-size:26px;box-shadow:0 0 16px rgba(126,200,80,.5);flex-shrink:0;position:relative;pointer-events:all;cursor:pointer}
.av-lv{position:absolute;bottom:-3px;right:-3px;background:#7ec850;color:#0a1e04;font-family:'Cinzel',serif;font-size:9px;font-weight:900;border-radius:7px;padding:1px 5px}
.hstat{display:flex;flex-direction:column;gap:4px;flex-shrink:0}
.hrow{display:flex;align-items:center;gap:5px;position:relative}
.hrow .hlabel{font-family:'Cinzel',serif;font-size:8px;letter-spacing:.5px;color:rgba(255,255,255,.55);text-transform:uppercase;min-width:28px;flex-shrink:0}
.hbar{width:90px;height:12px;background:rgba(0,0,0,.45);border:1px solid rgba(255,255,255,.12);border-radius:6px;overflow:hidden;flex-shrink:0}
.hbar-fill{height:100%;border-radius:6px;transition:width .4s}
.hbar-fill.hp{background:linear-gradient(90deg,#c62828,#f44336,#ff8a65)}
.hbar-fill.xp{background:linear-gradient(90deg,#2e7d32,#4caf50,#a5d6a7)}
.hval{font-size:11px;color:rgba(255,255,255,.85);font-weight:700;min-width:32px;font-family:'Cinzel',serif}
.hrow[data-tip]{cursor:help;pointer-events:all}
.hrow[data-tip]:hover::after{content:attr(data-tip);position:absolute;top:calc(100% + 6px);left:0;background:rgba(5,15,2,.97);border:1px solid rgba(126,200,80,.5);border-radius:8px;padding:6px 12px;font-family:'Nunito',sans-serif;font-size:12px;font-weight:700;color:#7ec850;white-space:nowrap;z-index:200;pointer-events:none}
.hmid{flex:1;display:flex;flex-direction:column;gap:3px;min-width:0}
.hlbl{font-family:'Cinzel',serif;font-size:8px;letter-spacing:2px;color:#7ec850;text-transform:uppercase;text-shadow:0 1px 3px rgba(0,0,0,.9)}
.hpbg{width:100%;height:14px;background:rgba(0,0,0,.45);border:1px solid rgba(255,255,255,.12);border-radius:8px;overflow:hidden;position:relative}
.hpfg{height:100%;background:linear-gradient(90deg,#2e7d32,#66bb6a,#a5d6a7);border-radius:8px;transition:width .7s cubic-bezier(.34,1.56,.64,1)}
.hptxt{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-family:'Cinzel',serif;font-size:10px;font-weight:700;color:#fff;text-shadow:0 1px 3px rgba(0,0,0,.9)}
.htimer{font-family:'Cinzel',serif;font-size:15px;font-weight:700;color:#a8e060;background:rgba(0,0,0,.5);border:1px solid rgba(126,200,80,.3);border-radius:8px;padding:4px 10px;letter-spacing:1px;flex-shrink:0}
.hcurs{display:flex;gap:6px;flex-shrink:0}
.hcur{display:flex;align-items:center;gap:4px;background:rgba(0,0,0,.55);border:2px solid rgba(255,255,255,.12);border-radius:20px;padding:4px 10px;font-family:'Cinzel',serif;font-weight:700;font-size:12px}
.hcur.c{color:#ffd54f;border-color:rgba(255,213,79,.3)}
.hcur.g{color:#e879f9;border-color:rgba(232,121,249,.3)}
#toolpanel{position:absolute;right:10px;top:50%;transform:translateY(-50%);display:flex;flex-direction:column;gap:7px;z-index:50;background:rgba(4,18,2,.9);border:2px solid rgba(126,200,80,.32);border-radius:18px;padding:10px 7px;box-shadow:0 4px 24px rgba(0,0,0,.7)}
.tp-title{font-family:'Cinzel',serif;font-size:8px;letter-spacing:2px;color:rgba(126,200,80,.55);text-transform:uppercase;text-align:center;margin-bottom:3px}
.ts{width:58px;height:58px;border-radius:14px;background:rgba(255,255,255,.06);border:2px solid rgba(255,255,255,.1);display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;transition:all .18s;position:relative}
.ts:hover{background:rgba(126,200,80,.16);border-color:rgba(126,200,80,.5);transform:scale(1.06)}
.ts.on{background:rgba(126,200,80,.24);border-color:#7ec850;box-shadow:0 0 18px rgba(126,200,80,.5)}
.ts.dim{opacity:.28;cursor:not-allowed;pointer-events:none}
.ts-ico{font-size:24px;line-height:1}
.ts-nm{font-size:7px;font-weight:800;color:rgba(255,255,255,.58);text-transform:uppercase;margin-top:2px}
.ts-cnt{position:absolute;top:-5px;right:-5px;background:#7ec850;color:#0a1e04;font-size:10px;font-weight:900;border-radius:10px;padding:0 5px;font-family:'Cinzel',serif;min-width:18px;text-align:center}
.ts-tooltip{position:absolute;right:calc(100% + 14px);top:50%;transform:translateY(-50%);background:rgba(4,18,2,.97);border:2px solid rgba(126,200,80,.45);border-radius:10px;padding:8px 12px;font-family:'Nunito',sans-serif;font-size:12px;font-weight:700;color:#fff;white-space:nowrap;pointer-events:none;opacity:0;transition:opacity .18s;z-index:100;min-width:180px}
.ts-tooltip .tt-title{font-family:'Cinzel',serif;font-size:11px;font-weight:700;color:#7ec850;margin-bottom:4px}
.ts-tooltip .tt-works{font-size:11px;color:rgba(255,255,255,.75)}
.ts-tooltip .tt-tip{font-size:10px;color:rgba(180,255,180,.8);margin-top:3px;font-style:italic}
.ts:hover .ts-tooltip{opacity:1}
#mm{position:absolute;top:72px;left:10px;width:108px;height:108px;background:rgba(4,18,2,.9);border:2px solid rgba(126,200,80,.35);border-radius:10px;z-index:45;overflow:hidden}
#mmcv{width:100%;height:100%}
#lvbadge{position:absolute;top:72px;left:126px;background:rgba(4,18,2,.9);border:2px solid rgba(126,200,80,.4);border-radius:8px;padding:4px 12px;font-family:'Cinzel',serif;font-size:10px;font-weight:700;color:#7ec850;z-index:45;letter-spacing:2px}
#qpanel{position:absolute;bottom:66px;left:10px;background:rgba(4,18,2,.92);border:2px solid rgba(126,200,80,.32);border-radius:12px;padding:10px 14px;z-index:45;max-width:210px}
.qp-h{font-family:'Cinzel',serif;font-size:9px;letter-spacing:3px;color:#7ec850;text-transform:uppercase;margin-bottom:6px}
.qp-r{display:flex;align-items:center;gap:8px;margin-bottom:4px;font-size:12px;font-weight:700;color:rgba(255,255,255,.82);line-height:1.3}
.qp-r.done{color:rgba(90,200,70,.8)}
.qp-r .qi{font-size:15px;flex-shrink:0}
#wrongtool{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%) scale(0);background:rgba(8,2,2,.97);border:3px solid #e53935;border-radius:16px;padding:18px 32px;z-index:190;text-align:center;pointer-events:none;transition:transform .3s cubic-bezier(.34,1.56,.64,1);max-width:380px;width:90%}
#wrongtool.show{transform:translate(-50%,-50%) scale(1)}
#wrongtool .wt-ico{font-size:38px;display:block;margin-bottom:6px}
#wrongtool .wt-title{font-family:'Cinzel',serif;font-size:17px;font-weight:700;color:#ff5252;margin-bottom:6px}
#wrongtool .wt-msg{font-family:'Nunito',sans-serif;font-size:14px;color:rgba(255,200,200,.85);line-height:1.5}
#wrongtool .wt-suggest{font-family:'Cinzel',serif;font-size:13px;color:#7ec850;margin-top:8px;padding:6px 12px;background:rgba(126,200,80,.12);border-radius:8px;border:1px solid rgba(126,200,80,.3)}
#bbar{position:absolute;bottom:0;left:0;right:0;height:60px;display:flex;align-items:center;justify-content:space-between;padding:0 12px;z-index:50;background:linear-gradient(0deg,rgba(0,10,0,.7)0%,transparent)}
.bb{background:rgba(4,14,2,.88);border:2px solid rgba(126,200,80,.3);border-radius:9px;color:#7ec850;font-family:'Cinzel',serif;font-size:10px;letter-spacing:1px;padding:8px 14px;cursor:pointer;transition:all .2s;text-transform:uppercase;font-weight:700;pointer-events:all}
.bb:hover{border-color:#7ec850;box-shadow:0 0 10px rgba(126,200,80,.3)}
#bbhint{font-family:'Cinzel',serif;font-size:8px;letter-spacing:1px;color:rgba(126,200,80,.45);text-align:center;flex:1;text-transform:uppercase}
#spch{position:absolute;background:rgba(255,252,240,.97);border:3px solid #7ec850;border-radius:14px;padding:10px 13px;font-size:13px;font-weight:700;color:#1a3a06;max-width:185px;z-index:55;box-shadow:0 4px 16px rgba(0,0,0,.5);display:none;pointer-events:none;line-height:1.4}
#spch::after{content:'';position:absolute;bottom:-11px;left:18px;border-left:10px solid transparent;border-right:10px solid transparent;border-top:11px solid #7ec850}
#achtoast{position:fixed;top:72px;left:50%;transform:translateX(-50%) translateY(-130px);background:linear-gradient(135deg,rgba(4,18,2,.97),rgba(10,30,4,.97));border:2px solid #7ec850;border-radius:14px;padding:12px 22px;z-index:200;display:flex;align-items:center;gap:12px;transition:transform .5s cubic-bezier(.34,1.56,.64,1);pointer-events:none}
#achtoast.show{transform:translateX(-50%) translateY(0)}
.ati{font-size:32px}
.att .atn{font-family:'Cinzel',serif;font-size:13px;font-weight:700;color:#7ec850}
.att .ats{font-size:11px;color:rgba(255,255,255,.7)}
#gbanner{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%) scale(0);background:rgba(4,18,2,.96);border:3px solid #7ec850;border-radius:16px;padding:18px 40px;font-family:'Cinzel',serif;font-size:22px;font-weight:700;color:#7ec850;z-index:180;text-align:center;transition:transform .35s cubic-bezier(.34,1.56,.64,1);pointer-events:none;box-shadow:0 0 60px rgba(126,200,80,.45)}
#gbanner.show{transform:translate(-50%,-50%) scale(1)}
#modal{position:fixed;inset:0;background:rgba(0,0,0,.8);z-index:100;display:flex;align-items:center;justify-content:center;backdrop-filter:blur(8px)}
#modal.hidden{display:none}
.parch{background:radial-gradient(ellipse at 22% 14%,rgba(200,240,180,.3)0%,transparent 54%),linear-gradient(160deg,#e8f5d8 0%,#c8e8a8 38%,#a8d070 72%,#88b840 100%);border:4px solid #4a8018;border-radius:18px;box-shadow:0 30px 90px rgba(0,0,0,.9);max-width:560px;width:96%;padding:28px 36px 24px;position:relative;animation:scUp .45s cubic-bezier(.34,1.56,.64,1);color:#1a3006}
@keyframes scUp{from{transform:scale(.65) translateY(40px);opacity:0}to{transform:scale(1);opacity:1}}
.pi{position:absolute;inset:10px;border:1px solid rgba(74,128,24,.22);border-radius:12px;pointer-events:none}
.pc{position:absolute;font-size:16px;color:#4a8018;opacity:.36}
.pc.tl{top:14px;left:18px}.pc.tr{top:14px;right:18px}.pc.bl{bottom:14px;left:18px}.pc.br{bottom:14px;right:18px}
.m-tier{font-family:'Cinzel',serif;font-size:10px;letter-spacing:5px;color:#2a5c08;text-align:center;text-transform:uppercase;margin-bottom:8px}
.m-gate-card{display:flex;align-items:center;gap:14px;margin-bottom:16px;padding:12px 18px;background:rgba(74,128,24,.13);border-radius:12px;border:2px solid rgba(74,128,24,.25)}
.m-gate-ico{font-size:42px;flex-shrink:0}
.m-gate-right{flex:1}
.m-gate-name{font-family:'Cinzel',serif;font-size:15px;font-weight:700;color:#2a5c08;letter-spacing:2px}
.m-gate-tool{display:flex;align-items:center;gap:6px;margin-top:5px;padding:5px 10px;background:rgba(74,128,24,.15);border:1px solid rgba(74,128,24,.35);border-radius:8px;font-size:12px;font-weight:700;color:#1a5808}
.m-gate-skipbtn{display:flex;align-items:center;gap:8px;width:100%;margin-bottom:14px;padding:10px 16px;background:linear-gradient(180deg,rgba(60,140,20,.85),rgba(30,90,10,.85));border:2px solid #7ec850;border-radius:11px;color:#d0f0a0;cursor:pointer;font-family:'Nunito',sans-serif;font-size:15px;font-weight:800;transition:all .2s}
.m-gate-skipbtn:hover{background:linear-gradient(180deg,rgba(80,160,30,.9),rgba(40,110,15,.9));transform:scale(1.02)}
.m-gate-skipbtn .sb-ico{font-size:22px;flex-shrink:0}
.m-gate-skipbtn .sb-main{font-size:14px;font-weight:800;display:block}
.m-gate-skipbtn .sb-sub{font-size:11px;color:rgba(200,240,160,.7);display:block;margin-top:1px}
.m-sent{font-family:'Nunito',sans-serif;font-size:22px;font-weight:800;text-align:center;line-height:1.55;margin-bottom:6px}
.m-blank{display:inline-block;min-width:90px;border-bottom:3px solid #4a8018;text-align:center;color:#1a5808;padding:0 8px}
.m-basefm{font-size:13px;font-style:italic;color:#3a6010;text-align:center;margin-bottom:18px}
.m-opts{display:flex;flex-direction:column;gap:9px;margin-bottom:12px}
.m-opt{background:linear-gradient(180deg,rgba(255,255,255,.24)0%,rgba(255,255,255,.05)100%);border:2px solid rgba(74,128,24,.42);border-radius:11px;color:#1a3006;cursor:pointer;font-family:'Nunito',sans-serif;font-size:20px;font-weight:700;padding:12px 18px;text-align:left;transition:all .18s}
.m-opt .ol{display:inline-flex;align-items:center;justify-content:center;width:30px;height:30px;background:#4a8018;color:#e8f5d8;border-radius:9px;font-family:'Cinzel',serif;font-size:13px;font-weight:700;margin-right:12px;flex-shrink:0}
.m-opt:hover:not(:disabled){background:rgba(200,240,150,.45);transform:translateX(6px);border-color:#4a8018}
.m-opt.ok{background:linear-gradient(180deg,#c8f5c0,#78d560);border-color:#3a8030!important}
.m-opt.bad{background:linear-gradient(180deg,#f5c0c0,#d06060);border-color:#903030!important;animation:shk .35s}
@keyframes shk{0%,100%{transform:translateX(0)}25%,75%{transform:translateX(-9px)}50%{transform:translateX(9px)}}
.m-fb{font-family:'Cinzel',serif;font-size:12px;font-weight:700;letter-spacing:2px;text-align:center;min-height:20px}
.m-fb.ok{color:#2a7020}.m-fb.bad{color:#8a2020}
.m-stats{display:flex;justify-content:center;gap:18px;margin-top:8px}
.m-stat{font-family:'Cinzel',serif;font-size:11px;color:#3a6010;display:flex;align-items:center;gap:4px}
#lvc{position:fixed;inset:0;background:rgba(0,0,0,.84);z-index:200;display:flex;align-items:center;justify-content:center}
#lvc.hidden{display:none}
.lcc{background:linear-gradient(150deg,#0a1e04,#051202);border:3px solid #7ec850;border-radius:20px;max-width:480px;width:95%;padding:38px;text-align:center;animation:zIn .6s cubic-bezier(.34,1.56,.64,1)}
@keyframes zIn{from{transform:scale(.65);opacity:0}to{transform:scale(1);opacity:1}}
.lc-ico{font-size:62px;animation:wb 3s ease-in-out infinite alternate}
@keyframes wb{from{transform:rotate(-6deg)}to{transform:rotate(6deg)}}
.lc-t{font-family:'Cinzel',serif;font-size:28px;font-weight:900;color:#7ec850;margin:10px 0 6px}
.lc-s{font-family:'Nunito',sans-serif;font-size:15px;color:#90c880;margin-bottom:22px}
.lc-sts{display:flex;justify-content:center;gap:22px;margin-bottom:22px;flex-wrap:wrap}
.lc-sv{font-family:'Cinzel',serif;font-size:24px;font-weight:700;color:#7ec850;display:block}
.lc-sl{font-family:'Nunito',sans-serif;font-size:10px;color:#5a7850;letter-spacing:2px;text-transform:uppercase}
.lc-ah{display:flex;flex-wrap:wrap;justify-content:center;gap:7px;margin-bottom:20px}
.ab{background:rgba(126,200,80,.14);border:1px solid rgba(126,200,80,.3);border-radius:8px;padding:4px 10px;font-size:11px;color:#7ec850;font-family:'Cinzel',serif}
#ge{position:fixed;inset:0;background:rgba(0,0,0,.92);z-index:300;display:flex;align-items:center;justify-content:center}
#ge.hidden{display:none}
.gec{background:linear-gradient(150deg,#e8f5d8,#c8e8a8 40%,#a0c870 100%);border:4px solid #4a8018;border-radius:20px;max-width:560px;width:95%;padding:42px;text-align:center;color:#1a3006;animation:zIn .6s cubic-bezier(.34,1.56,.64,1);position:relative}
.gei{position:absolute;inset:10px;border:1px solid rgba(74,128,24,.22);border-radius:14px;pointer-events:none}
.ge-ico{font-size:62px;animation:wb 4s ease-in-out infinite alternate}
.ge-pre{font-family:'Cinzel',serif;font-size:9px;letter-spacing:5px;color:#4a8018;text-transform:uppercase;margin-bottom:4px}
.ge-t{font-family:'Cinzel',serif;font-size:26px;font-weight:900;color:#1a3006;margin-bottom:14px}
.ge-sts{display:flex;justify-content:center;gap:22px;margin-bottom:20px;flex-wrap:wrap}
.ge-sv{font-family:'Cinzel',serif;font-size:24px;font-weight:700;color:#4a8018;display:block}
.ge-sl{font-family:'Nunito',sans-serif;font-size:10px;color:#3a6010;letter-spacing:2px;text-transform:uppercase}
.ge-ah{display:flex;flex-wrap:wrap;justify-content:center;gap:8px;margin-bottom:18px}
#ss{position:absolute;inset:0;z-index:200;background:radial-gradient(ellipse at 50% 30%,#1a6818,#040a02 100%);display:flex;align-items:center;justify-content:center}
#ss.hidden{display:none}
.ssc{background:rgba(4,14,2,.95);border:3px solid #7ec850;border-radius:22px;padding:40px 46px;text-align:center;max-width:520px;width:95%;box-shadow:0 0 90px rgba(126,200,80,.2)}
.ss-lo{font-size:60px;animation:bob 2.5s ease-in-out infinite}
@keyframes bob{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
.ss-sub{font-family:'Cinzel',serif;font-size:10px;letter-spacing:5px;color:#3a7018;text-transform:uppercase;margin-bottom:4px}
.ss-ti{font-family:'Cinzel',serif;font-size:clamp(24px,5vw,46px);font-weight:900;color:#7ec850;text-shadow:0 0 32px rgba(126,200,80,.5);line-height:1.1;margin-bottom:6px}
.ss-tg{font-family:'Nunito',sans-serif;font-size:16px;color:#6a9850;margin-bottom:10px}
.ss-de{font-family:'Nunito',sans-serif;font-size:13px;color:#3a5838;margin-bottom:24px;line-height:1.7}
.ss-de b{color:#7ec850}
.ss-lb{font-family:'Cinzel',serif;font-size:11px;letter-spacing:3px;color:#7ec850;text-transform:uppercase;display:block;margin-bottom:8px}
.ss-in{background:rgba(255,255,255,.05);border:2px solid #2a5810;border-radius:9px;color:#c8f0a0;font-family:'Nunito',sans-serif;font-size:18px;padding:11px 18px;text-align:center;outline:none;width:100%;margin-bottom:20px;transition:border-color .3s}
.ss-in:focus{border-color:#7ec850}
.bg{background:linear-gradient(180deg,#3a7010,#1a4808 60%,#0e3004 100%);border:2px solid #7ec850;border-radius:11px;color:#c8f080;cursor:pointer;font-family:'Cinzel',serif;font-size:15px;font-weight:700;letter-spacing:3px;padding:14px 42px;text-transform:uppercase;transition:all .25s}
.bg:hover{background:linear-gradient(180deg,#4a8820,#2a5810 60%,#1a4408 100%);transform:translateY(-2px)}
.ft{position:fixed;font-family:'Cinzel',serif;font-size:22px;font-weight:700;pointer-events:none;z-index:150;animation:ftu 1.3s ease forwards;text-shadow:0 2px 8px rgba(0,0,0,.9)}
@keyframes ftu{0%{transform:translateY(0) scale(1.2);opacity:1}100%{transform:translateY(-110px) scale(.8);opacity:0}}
.ft.ok{color:#4caf50}.ft.bad{color:#e53935}.ft.coin{color:#ffd54f}.ft.tool{color:#80cfff}
.cf{position:fixed;pointer-events:none;z-index:200;animation:cff linear forwards}
@keyframes cff{0%{opacity:1;transform:translateY(-10px) rotate(0)}100%{opacity:0;transform:translateY(110vh) rotate(720deg)}}
</style>
</head>
<body>
<div id="G">
<div id="ss">
<div class="ssc">
<div class="ss-lo">üåø</div>
<div class="ss-sub">Grammar Adventure RPG</div>
<div class="ss-ti">Maze of Verbs</div>
<div class="ss-tg">Hedge Garden ‚Äî Irregular Verbs Quest</div>
<div class="ss-de">
üß≠ Walk through the <b>round hedge maze</b> as an explorer<br>
üîí Gates <b>block corridors</b> ‚Äî answer grammar questions to pass<br>
üéØ Reach the <b>red X</b> in the center to win!<br>
‚û°Ô∏è <b>Yellow arrows</b> always show you the way!
</div>
<label class="ss-lb">Your Explorer's Name</label>
<input class="ss-in" id="nameIn" type="text" placeholder="Enter your name‚Ä¶" maxlength="22" autocomplete="off">
<button class="bg" id="startBtn">üåø Enter the Maze</button>
</div>
</div>
<canvas id="gc"></canvas>
<div id="hud">
<div class="av" title="Your hero">üß≠<div class="av-lv" id="avLv">1</div></div>
<div class="hstat">
<div class="hrow" data-tip="‚ù§Ô∏è HP ‚Äî Lives remaining">
<span class="hlabel">‚ù§Ô∏è HP</span>
<div class="hbar"><div class="hbar-fill hp" id="hpBar" style="width:100%"></div></div>
<span class="hval" id="hpVal">3/3</span>
</div>
<div class="hrow" data-tip="‚≠ê XP ‚Äî Experience points">
<span class="hlabel">‚≠ê XP</span>
<div class="hbar"><div class="hbar-fill xp" id="xpBar" style="width:0%"></div></div>
<span class="hval" id="xpVal">0/100</span>
</div>
</div>
<div class="hmid">
<div class="hlbl" id="progLbl">Level 1 ‚Äî Open all gates!</div>
<div class="hpbg"><div class="hpfg" id="progFg" style="width:0%"></div><div class="hptxt" id="progTxt">0/6 gates</div></div>
</div>
<div class="htimer" id="timer">00:00</div>
<div class="hcurs">
<div class="hcur g"><span>üíé</span><span id="gemC">5</span></div>
<div class="hcur c"><span>ü™ô</span><span id="coinC">100</span></div>
</div>
</div>
<div id="lvbadge">LEVEL <span id="lvNum">1</span></div>
<div id="mm"><canvas id="mmcv" width="108" height="108"></canvas></div>
<div id="qpanel">
<div class="qp-h">üìã Quest</div>
<div class="qp-r" id="qr1"><span class="qi">üîí</span><span id="qr1t">Open all gates</span></div>
<div class="qp-r" id="qr2"><span class="qi">‚ùå</span><span id="qr2t">Reach the red X center!</span></div>
</div>
<div id="toolpanel">
<div class="tp-title">TOOLS</div>
<div class="ts on" id="t0"><div class="ts-ico">üë£</div><div class="ts-nm">Walk</div>
<div class="ts-tooltip"><div class="tt-title">Walk Mode</div><div class="tt-works">Click anywhere to move</div><div class="tt-tip">Click a gate to answer</div></div>
</div>
<div class="ts" id="t1"><div class="ts-ico">ü™ì</div><div class="ts-nm">Axe</div><span class="ts-cnt" id="tc1">3</span>
<div class="ts-tooltip"><div class="tt-title">ü™ì Axe</div><div class="tt-works">Works on: üåø Vine Gates</div><div class="tt-tip">Chop through hedges!</div></div>
</div>
<div class="ts" id="t2"><div class="ts-ico">‚õèÔ∏è</div><div class="ts-nm">Pick</div><span class="ts-cnt" id="tc2">2</span>
<div class="ts-tooltip"><div class="tt-title">‚õèÔ∏è Pickaxe</div><div class="tt-works">Works on: ‚õ©Ô∏è Stone, üéã Bamboo</div><div class="tt-tip">Break stone barriers!</div></div>
</div>
<div class="ts" id="t3"><div class="ts-ico">üóùÔ∏è</div><div class="ts-nm">Key</div><span class="ts-cnt" id="tc3">1</span>
<div class="ts-tooltip"><div class="tt-title">üóùÔ∏è Magic Key</div><div class="tt-works">Works on: üîÆ Rune Doors</div><div class="tt-tip">Unlock magical gates!</div></div>
</div>
<div class="ts" id="t4"><div class="ts-ico">‚ú®</div><div class="ts-nm">Magic</div><span class="ts-cnt" id="tc4">1</span>
<div class="ts-tooltip"><div class="tt-title">‚ú® Magic Scroll</div><div class="tt-works">Works on: ALL gate types!</div><div class="tt-tip">Instant clear!</div></div>
</div>
</div>
<div id="bbar">
<button class="bb" id="hintBtn">üí° Hint (‚àí5ü™ô)</button>
<div id="bbhint">Click to walk ¬∑ Click gates to answer ¬∑ Find the red X!</div>
<button class="bb" id="pauseBtn">‚è∏ Pause</button>
</div>
<div id="spch"></div>
<div id="achtoast"><div class="ati" id="ati">üèÜ</div><div class="att"><div class="atn" id="atn">Achievement!</div><div class="ats" id="ats">Unlocked</div></div></div>
<div id="gbanner">üîì Gate Opened!</div>
<div id="wrongtool">
<span class="wt-ico" id="wt-ico">‚ùå</span>
<div class="wt-title" id="wt-title">Wrong Tool!</div>
<div class="wt-msg" id="wt-msg">That tool won't work here.</div>
<div class="wt-suggest" id="wt-suggest">Use ü™ì Axe instead!</div>
</div>
<div id="modal" class="hidden">
<div class="parch">
<div class="pi"></div>
<span class="pc tl">üåø</span><span class="pc tr">üå∫</span><span class="pc bl">üçÉ</span><span class="pc br">üå∏</span>
<div class="m-tier" id="mTier">Common Verbs ‚Äî Tier I</div>
<div class="m-gate-card">
<div class="m-gate-ico" id="mGIco">üåø</div>
<div class="m-gate-right">
<div class="m-gate-name" id="mGName">HEDGE GATE</div>
<div class="m-gate-tool"><span class="tool-ico" id="mToolIco">ü™ì</span><span id="mToolMsg">Or use Axe to skip</span></div>
</div>
</div>
<button class="m-gate-skipbtn hidden" id="mSkipBtn">
<span class="sb-ico" id="mSkipIco">ü™ì</span>
<span class="sb-txt"><span class="sb-main" id="mSkipMain">Use Axe to chop this gate!</span><span class="sb-sub" id="mSkipSub">3 uses remaining</span></span>
</button>
<div class="m-sent" id="mSent"></div>
<div class="m-basefm" id="mBase">Base form: "go"</div>
<div class="m-opts" id="mOpts"></div>
<div class="m-fb" id="mFb"></div>
<div class="m-stats">
<div class="m-stat">üéØ Streak: <span id="mStr">0</span></div>
<div class="m-stat">‚úÖ Accuracy: <span id="mAcc">‚Äî</span></div>
<div class="m-stat">ü™ô +10 on correct</div>
</div>
</div>
</div>
<div id="lvc" class="hidden">
<div class="lcc">
<div class="lc-ico">üéä</div>
<div class="lc-t" id="lcT">Maze Cleared!</div>
<div class="lc-s" id="lcS">You reached the center!</div>
<div class="lc-sts">
<div><span class="lc-sv" id="lcSc">0</span><span class="lc-sl">Score</span></div>
<div><span class="lc-sv" id="lcAc">100%</span><span class="lc-sl">Accuracy</span></div>
<div><span class="lc-sv" id="lcTm">0:00</span><span class="lc-sl">Time</span></div>
<div><span class="lc-sv" id="lcRw">+50ü™ô</span><span class="lc-sl">Reward</span></div>
</div>
<div class="lc-ah" id="lcAh"></div>
<button class="bg" id="nextBtn">Next Level ‚ñ∂</button>
</div>
</div>
<div id="ge" class="hidden">
<div class="gec"><div class="gei"></div>
<div class="ge-ico">üèÜ</div>
<div class="ge-pre">Certificate of Mastery</div>
<div class="ge-t" id="geT">Maze Champion!</div>
<div class="ge-sts">
<div><span class="ge-sv" id="geSc">0</span><span class="ge-sl">Score</span></div>
<div><span class="ge-sv" id="geAc">0%</span><span class="ge-sl">Accuracy</span></div>
<div><span class="ge-sv" id="geTm">0:00</span><span class="ge-sl">Time</span></div>
<div><span class="ge-sv" id="geLv">1</span><span class="ge-sl">Levels</span></div>
</div>
<div class="ge-ah" id="geAh"></div>
<button class="bg" id="replayBtn">üîÑ Play Again</button>
</div>
</div>
<script>
(()=>{
'use strict';

// ==========================================
// CUSTOM GATE IMAGE CONFIGURATION
// ==========================================
// 1. Convert your image to Base64 (use a site like base64-image.de)
// 2. Paste the code inside the quotes below.
const CUSTOM_GATE_SRC = ""; // –í–°–¢–ê–í–¨–¢–ï –°–Æ–î–ê –í–ê–® –ö–û–î BASE64
// ==========================================

const VERBS=[
{b:'go',p:'went',d:['goed','gone'],t:1},{b:'take',p:'took',d:['taked','tooked'],t:1},
{b:'see',p:'saw',d:['seed','seen'],t:1},{b:'come',p:'came',d:['comed','come'],t:1},
{b:'get',p:'got',d:['getted','gotten'],t:1},{b:'make',p:'made',d:['maked','maed'],t:1},
{b:'know',p:'knew',d:['knowed','known'],t:1},{b:'think',p:'thought',d:['thinked','thunk'],t:1},
{b:'say',p:'said',d:['sayed','sed'],t:1},{b:'give',p:'gave',d:['gived','gaven'],t:1},
{b:'find',p:'found',d:['finded','founded'],t:1},{b:'tell',p:'told',d:['telled','tolded'],t:1},
{b:'write',p:'wrote',d:['writed','written'],t:2},{b:'break',p:'broke',d:['breaked','broked'],t:2},
{b:'speak',p:'spoke',d:['speaked','spoken'],t:2},{b:'drive',p:'drove',d:['drived','driven'],t:2},
{b:'choose',p:'chose',d:['choosed','chosen'],t:2},{b:'steal',p:'stole',d:['stealed','stolen'],t:2},
{b:'wear',p:'wore',d:['weared','worn'],t:2},{b:'forget',p:'forgot',d:['forgetted','forgotten'],t:2},
{b:'begin',p:'began',d:['beginned','begun'],t:2},{b:'swim',p:'swam',d:['swimmed','swum'],t:2},
{b:'seek',p:'sought',d:['seeked','sook'],t:3},{b:'flee',p:'fled',d:['fleed','flied'],t:3},
{b:'bind',p:'bound',d:['binded','bounden'],t:3},{b:'weave',p:'wove',d:['weaved','woven'],t:3},
{b:'slay',p:'slew',d:['slayed','slain'],t:3},{b:'awake',p:'awoke',d:['awaked','awaken'],t:3},
{b:'shine',p:'shone',d:['shined','shon'],t:3},{b:'deal',p:'dealt',d:['dealed','dealt'],t:3},
];
const SENTS=[
'Yesterday our explorer ______ through the hedge maze.',
'The ancient wizard ______ a powerful spell.',
'She bravely ______ the secret chamber.',
'He ______ through the dark green corridor.',
'They ______ the hidden passage at night.',
'The explorer ______ a strange artifact.',
'She ______ the answer to the ancient riddle.',
'He ______ deep into the garden labyrinth.',
'The guardian ______ into the shadows.',
'The brave knight ______ the path to the center.',
'She ______ about the danger and escaped.',
'Our guide ______ us through the maze.',
];
const TIER_LBL={1:'Common Verbs ‚Äî Tier I',2:'Intermediate ‚Äî Tier II',3:'Advanced ‚Äî Tier III'};
const GATE_DATA={
iron_gate:{nm:'STONE GATE',ic:'‚õ©Ô∏è',tool:'t2',toolIco:'‚õèÔ∏è',toolNm:'Pickaxe',msg:'Use ‚õèÔ∏è Pickaxe to smash it!'},
vine_gate:{nm:'HEDGE GATE',ic:'üåø',tool:'t1',toolIco:'ü™ì',toolNm:'Axe',msg:'Use ü™ì Axe to chop it!'},
rune_door:{nm:'RUNE DOOR',ic:'üîÆ',tool:'t3',toolIco:'üóùÔ∏è',toolNm:'Key',msg:'Use üóùÔ∏è Key to unlock!'},
spike_gate:{nm:'THORN WALL',ic:'üåµ',tool:'t2',toolIco:'‚õèÔ∏è',toolNm:'Pickaxe',msg:'Use ‚õèÔ∏è Pickaxe to break!'},
};
const TOOL_COMPAT={t1:['vine_gate'],t2:['iron_gate','spike_gate'],t3:['rune_door'],t4:['iron_gate','vine_gate','rune_door','spike_gate']};
const TOOL_ICO={t1:'ü™ì',t2:'‚õèÔ∏è',t3:'üóùÔ∏è',t4:'‚ú®'};
const WRONG_MSGS={
t1:{iron_gate:'ü™ì Axe can\'t break stone! Use ‚õèÔ∏è Pickaxe.',vine_gate:null,rune_door:'ü™ì Axe can\'t break runes! Use üóùÔ∏è Key.',spike_gate:'ü™ì Axe won\'t work! Use ‚õèÔ∏è Pickaxe.'},
t2:{iron_gate:null,vine_gate:'‚õèÔ∏è Pickaxe can\'t cut hedges! Use ü™ì Axe.',rune_door:'‚õèÔ∏è Pickaxe won\'t work on magic! Use üóùÔ∏è Key.',spike_gate:null},
t3:{iron_gate:'üóùÔ∏è Key can\'t open stone! Use ‚õèÔ∏è Pickaxe.',vine_gate:'üóùÔ∏è Key won\'t cut hedges! Use ü™ì Axe.',rune_door:null,spike_gate:'üóùÔ∏è Key can\'t break thorns! Use ‚õèÔ∏è Pickaxe.'},
};
const NPC_LINES=[
['Follow the yellow arrows!','The red X is in the center!','Open all gates first!'],
['Answer correctly ‚Äî gates open!','Use tools as shortcuts!','Watch the flashing gates!'],
['Woof! Follow me! üêï','*sniffs* This way!','Bark! Gate over there!'],
['Right tool = instant open!','Magic works on everything!','Need a key? Check tools!'],
];
const ACHS=[
{id:'a1',nm:'Gate Breaker',ds:'Open your first gate',ic:'üîì',fn:s=>s.cl>=1},
{id:'a2',nm:'Sharpshooter',ds:'5 correct answers in a row',ic:'üéØ',fn:s=>s.str>=5},
{id:'a3',nm:'Handyman',ds:'Use a tool on a gate',ic:'ü™ì',fn:s=>s.tu>=1},
{id:'a4',nm:'Trailblazer',ds:'Clear 10 gates total',ic:'üó∫Ô∏è',fn:s=>s.tc>=10},
{id:'a5',nm:'Scholar',ds:'20 correct answers',ic:'üìö',fn:s=>s.cor>=20},
{id:'a6',nm:'Pathfinder',ds:'Complete Level 1',ic:'üèÅ',fn:s=>s.lvc>=1},
{id:'a7',nm:'Untouchable',ds:'Level with no HP loss',ic:'üõ°Ô∏è',fn:s=>s.hloss===0},
{id:'a8',nm:'Speedster',ds:'Clear level under 90s',ic:'‚ö°',fn:s=>s.lt<90},
{id:'a9',nm:'Perfectionist',ds:'100% accuracy in a level',ic:'üíé',fn:s=>s.lacc>=100},
];
const CV=document.getElementById('gc');const CX=CV.getContext('2d');
const MC=document.getElementById('mmcv');const MX=MC.getContext('2d');
const COLS=19,ROWS=15;
const TW=100,TH=50,WH=72;
let W=0,H=0,OX=0,OY=0,SC=1;
let camX=0,camY=0,ctX=0,ctY=0;
// Centre of the circular maze
const CX_MAZE=9,CY_MAZE=7;
// Exit is at the very centre
let exitPos={col:CX_MAZE,row:CY_MAZE};
function resize(){
W=CV.width=window.innerWidth;H=CV.height=window.innerHeight;
const mW=(COLS+ROWS)*TW/2,mH=(COLS+ROWS)*TH/2+WH+20;
SC=Math.min(W*.60/mW,(H-66)*.63/mH,1.2);
OX=W/2;
OY=H*0.50-(CX_MAZE+CY_MAZE)*TH/2*SC;
}
function iso(c,r){return{x:OX+(c-r)*TW/2*SC-camX,y:OY+(c+r)*TH/2*SC-camY};}
function s2g(sx,sy){
const wx=sx+camX-OX,wy=sy+camY-OY;
return{col:Math.round((wx/(TW/2*SC)+wy/(TH/2*SC))/2),row:Math.round((wy/(TH/2*SC)-wx/(TW/2*SC))/2)};
}
let maze=[],gates=[],npcs=[],decors=[];
let verbQ=[],pPos={col:1,row:1};
let playerName='Explorer';
let score=0,hp=3,mhp=3,xp=0,lvl=1,coins=100,gems=5;
let totAns=0,corrAns=0,clrObs=0,totGates=6;
let active=false,inModal=false,paused=false;
let elapsed=0,timerID=null,curLvl=1,lastTs=0;
let facing=1,walkT=0;
let mPath=[],mTimer=0;const MDUR=0.16;
let curGate=null,curVerb=null;
let parts=[],gHits=[],nHits=[];
let opening=[];let arrowPath=[];const TOTAL_LVL=5;
let ST={cl:0,str:0,tu:0,tc:0,cor:0,lvc:0,hloss:0,lt:0,lacc:0};
let achDone=new Set();let lvlTs=0,lvlTot=0,lvlCorr=0;
const STOCK={t1:3,t2:2,t3:1,t4:1};
let curTool='t0';

// Load Custom Gate Image
let CUSTOM_GATE_IMG = null;
if(CUSTOM_GATE_SRC && CUSTOM_GATE_SRC.length > 50) {
    CUSTOM_GATE_IMG = new Image();
    CUSTOM_GATE_IMG.src = CUSTOM_GATE_SRC;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CIRCULAR MAZE BUILD
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function inCircle(c,r){
const dx=(c-CX_MAZE)/8.5,dy=(r-CY_MAZE)/6.2;
return dx*dx+dy*dy<=1.0;
}
function shuf(a){const b=[...a];for(let i=b.length-1;i>0;i--){const j=0|Math.random()*(i+1);[b[i],b[j]]=[b[j],b[i]];}return b;}
function buildMaze(){
// Start with all walls
maze=Array.from({length:ROWS},(_,r)=>Array.from({length:COLS},(_,c)=>inCircle(c,r)?1:2));
// 2 = outside circle (invisible), 1 = wall inside circle, 0 = floor path
// Recursive backtracker only inside circle
function carve(r,c){
maze[r][c]=0;
for(const[dr,dc]of shuf([[0,2],[0,-2],[2,0],[-2,0]])){
const nr=r+dr,nc=c+dc;
if(nr>=0&&nr<ROWS&&nc>=0&&nc<COLS&&inCircle(nc,nr)&&maze[nr][nc]===1){
maze[r+dr/2][c+dc/2]=0;
carve(nr,nc);
}
}
}
// Start from near edge on left
const startR=CY_MAZE,startC=1;
maze[startR][startC]=0;
carve(startR,startC);
// Extra openings for more paths (richer maze)
for(let i=0;i<18;i++){
const r=1+Math.floor(Math.random()*(ROWS-2));
const c=1+Math.floor(Math.random()*(COLS-2));
if(inCircle(c,r))maze[r][c]=0;
}
// Center always open (2x2)
for(let dr=-1;dr<=1;dr++)for(let dc=-1;dc<=1;dc++){
if(inCircle(CX_MAZE+dc,CY_MAZE+dr))maze[CY_MAZE+dr][CX_MAZE+dc]=0;
}
// Start position always open
maze[CY_MAZE][1]=0;maze[CY_MAZE][2]=0;maze[CY_MAZE-1][1]=0;
pPos={col:1,row:CY_MAZE};
}
function openCells(excl=[]){
const out=[];
for(let r=0;r<ROWS;r++)for(let c=0;c<COLS;c++){
if(maze[r][c]===0
&&!(r===CY_MAZE&&c<=2)
&&!(r===exitPos.row&&c===exitPos.col)
&&!excl.find(e=>e.row===r&&e.col===c))
out.push({row:r,col:c});
}
return out;
}
function bfs(sc,sr,ec,er,thru=false){
if(sc===ec&&sr===er)return[];
const key=(c,r)=>c+','+r,q=[{c:sc,r:sr,p:[]}],vis=new Set([key(sc,sr)]);
while(q.length){
const{c,r,p}=q.shift();
for(const[dc,dr]of[[0,-1],[0,1],[-1,0],[1,0]]){
const nc=c+dc,nr=r+dr;
if(nc<0||nr<0||nc>=COLS||nr>=ROWS||vis.has(key(nc,nr)))continue;
if(maze[nr][nc]===1||maze[nr][nc]===2)continue;
const gh=!thru&&gates.find(g=>g.col===nc&&g.row===nr&&!g.clr);
const np=[...p,{col:nc,row:nr}];
if(nc===ec&&nr===er)return np;
if(gh)continue;
vis.add(key(nc,nr));q.push({c:nc,r:nr,p:np});
}
}
return null;
}
function updArrows(){
const rem=gates.filter(g=>!g.clr);
if(!rem.length){arrowPath=bfs(pPos.col,pPos.row,exitPos.col,exitPos.row,true)||[];}
else{
let best=null,bd=9999;
rem.forEach(g=>{const d=Math.abs(g.col-pPos.col)+Math.abs(g.row-pPos.row);if(d<bd){bd=d;best=g;}});
arrowPath=best?bfs(pPos.col,pPos.row,best.col,best.row,true)||[]:[];
}
updQuest();
}
function updQuest(){
const rem=gates.filter(g=>!g.clr).length;
const r1=document.getElementById('qr1'),r2=document.getElementById('qr2');
const r1t=document.getElementById('qr1t'),r2t=document.getElementById('qr2t');
if(!rem){r1.className='qp-r done';r1t.textContent='All gates open! ‚úÖ';}
else{r1.className='qp-r';r1t.textContent=`Open ${rem} more gate${rem>1?'s':''}‚Ä¶`;}
if(!rem){r2.className='qp-r';r2t.textContent='‚Üí Go to red X center!';}
else{r2.className='qp-r';r2t.textContent='Exit locked until all gates open';}
}
function setupLevel(){
exitPos={col:CX_MAZE,row:CY_MAZE};
buildMaze();
const gcnt=Math.min(4+curLvl*2,12);totGates=gcnt;clrObs=0;
const cells=shuf(openCells());let used=[];
gates=[];
const gTypes=['iron_gate','vine_gate','rune_door','spike_gate'];
cells.slice(0,gcnt).forEach((p,i)=>{gates.push({...p,clr:false,type:gTypes[i%4],oa:0});used.push(p);});
npcs=[];
shuf(cells).filter(p=>!used.find(u=>u.row===p.row&&u.col===p.col)).slice(0,Math.min(2,curLvl)).forEach((p,i)=>{
npcs.push({...p,type:['old_man','child','dog','merchant'][i%4],ms:i%4});used.push(p);
});
decors=[];
const dT=['flower','mushroom','flower','rock','flower','mushroom'];
shuf(cells).filter(p=>!used.find(u=>u.row===p.row&&u.col===p.col)).slice(0,10+curLvl).forEach((p,i)=>{
decors.push({...p,type:dT[i%6]});
});
verbQ=shuf([...VERBS]);mPath=[];opening=[];
ST.hloss=0;ST.lacc=0;lvlTs=elapsed;lvlTot=0;lvlCorr=0;
updArrows();
}
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// BACKGROUND ‚Äî jungle + maze (black removed via pixels)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let _bgImg=null,_mazeImg=null,_mazeCanvas=null,_heroImg=null,_heroCanvas=null;
// Remove black background from an image ‚Üí returns canvas with transparent bg
function removeBlackBg(img,threshold=40){
const oc=document.createElement('canvas');
oc.width=img.naturalWidth;oc.height=img.naturalHeight;
const ox=oc.getContext('2d');
ox.drawImage(img,0,0);
const id=ox.getImageData(0,0,oc.width,oc.height);
const d=id.data;
for(let i=0;i<d.length;i+=4){
const r=d[i],g=d[i+1],b=d[i+2];
// If pixel is near-black ‚Üí make transparent
if(r<threshold&&g<threshold&&b<threshold){
d[i+3]=0;
} else {
// Smooth edge: partial transparency for dark pixels
const darkness=Math.max(0,threshold-(r+g+b)/3);
if(darkness>0) d[i+3]=Math.round(255*(1-darkness/threshold));
}
}
ox.putImageData(id,0,0);
return oc;
}
function _initImages(){
if(!_bgImg){
_bgImg=new Image();
_bgImg.src='data:image/png;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/4gHYSUNDX1BST0ZJTEUAAQEAAAHIAAAAAAQwAABtbnRyUkdCIFhZWiAH4AABAAEAAAAAAABhY3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlkZXNjAAAA8AAAACRyWFlaAAABFAAAABRnWFlaAAABKAAAABRiWFlaAAABPAAAABR3dHB0AAABUAAAABRyVFJDAAABZAAAAChnVFJDAAABZAAAAChiVFJDAAABZAAAAChjcHJ0AAABjAAAADxtbHVjAAAAAAAAAAEAAAAMZW5VUwAAAAgAAAAcAHMAUgBHAEJYWVogAAAAAAAAb6IAADj1AAADkFhZWiAAAAAAAABimQAAt4UAABjaWFlaIAAAAAAAACSgAAAPhAAAts9YWVogAAAAAAAA9tYAAQAAAADTLXBhcmEAAAAAAAQAAAACZmYAAPKnAAANWQAAE9AAAApbAAAAAAAAAABtbHVjAAAAAAAAAAEAAAAMZW5VUwAAACAAAAAcAEcAbwBvAGcAbABlACAASQBuAGMALgAgADIAMAAxADb/2wBDAAUDBAQEAwUEBAQFBQUGBwwIBwcHBw8LCwkMEQ8SEhEPERETFhwXExQaFRERGCEYGh0dHx8fExciJCIeJBweHx7/2wBDAQUFBQcGBw4ICA4eFBEUHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh7/wAARCAU1B9ADASIAAhEBAxEB/8QAHQAAAQUBAQEBAAAAAAAAAAAAAQACAwQFBgcICf/EAE4QAAEEAQIEBAMGBAQEBAQBDQEAAgMRBBIhBTFBUQYTImEycYEHFEJSkaEjscHRFTNickOC4fAIJFOSFjRj8SVzg6IXRFSTssLSNYTi/8QAGwEAAgMBAQEAAAAAAAAAAAAAAAECAwQFBgf/xABBEQACAgEDAwIDBwMEAgEDAQkAAQIRAwQSIQUxQRNRImFxBhQygZGhscHR8BUjQuEzUvEWJGIHQ4KScqI0RFPC/9oADAMBAAIRAxEAPwD6+Deqe1qDQnhWNmCKHNCd80AEVA0JUBJJJACSSRTGJJFJAxIIpIACWyKVJABBFJAgJUkkgBIIpJiAkkkkISSSNIASCJTSmDEihaBSQQsdacEwKQIJRAkiQlSRJoCSSSAEkkkgBJJJJgEJIJFAXQidlFIU5x2UTypRRRklYxxTbScUwlXJGVsdaVplpA7p0RskCc0qMFOCi0SiTNKcFECpAVW0XxYaQICNpdVEnQKTmhIBPAQ2SjEQCcgkolqCU1zbTkimmDVorvaoXhW3i1BK1WRkZMkKKMzAbVGZtLTlCoZI5rbiZzssUUJCq8pViZU5it0FZhmQSvVOZ9hSzO5qpK5bIRMeSRDM+lh8Wk1Ai1p5smlhdbklkZMkKKMzAbVGZtLTlCoZI5rbiZzssUUJCq8pViZU5it0FZhmQSvVOZ9hSzO5qpK5bIRMeSRDM+lh8Wk1Ai1p5smlhdbklkZMkKKMzAbVGZtLTlCoZI5rbiZzssUUJCq8pViZU5it0FZhmQSvVOZ9hSzO5qpK5bIRMeSRDM+lh8Wk1Ai1p5smlhdbklkZMkKKMzAbVGZtLTlCoZI5rbiZzssUUJCq8pViZU5it0FZhmQSvVOZ9hSzO5qpK5bIRMeSRDM+lh8Wk1Ai1p5smlhdbklkZMkKKMzAbVGZtLTlCoZI5rbiZzssUUJCq8pViZU5it0FZhmQSvVOZ9hSzO5qpK5bIRMeSRDM+lh8Wk1Ai1p5smlhdbklkZMkKKMzAbVGZtLTlCoZI5rbiZzssUUJCq8pViZU5it0FZhmQSvVOZ9hSzO5qpK5bIRMeSRDM+lh8Wk1
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>Maze of Verbs ‚Äî Hedge</title>
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Nunito:wght@600;700;800;900&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
html,body{width:100%;height:100%;overflow:hidden;background:#0a1a04;font-family:'Nunito',sans-serif;user-select:none;-webkit-user-select:none}
#G{position:relative;width:100%;height:100%}
canvas{display:block;position:absolute;inset:0;width:100%;height:100%;cursor:pointer}
#hud{position:absolute;top:0;left:0;right:0;height:66px;display:flex;align-items:center;gap:8px;padding:6px 12px;z-index:50;pointer-events:none;background:linear-gradient(180deg,rgba(0,20,0,.85)0%,transparent)}
.av{width:54px;height:54px;border:3px solid #7ec850;border-radius:50%;background:radial-gradient(#2a5a10,#0a1e04);display:flex;align-items:center;justify-content:center;font-size:26px;box-shadow:0 0 16px rgba(126,200,80,.5);flex-shrink:0;position:relative;pointer-events:all;cursor:pointer}
.av-lv{position:absolute;bottom:-3px;right:-3px;background:#7ec850;color:#0a1e04;font-family:'Cinzel',serif;font-size:9px;font-weight:900;border-radius:7px;padding:1px 5px}
.hstat{display:flex;flex-direction:column;gap:4px;flex-shrink:0}
.hrow{display:flex;align-items:center;gap:5px;position:relative}
.hrow .hlabel{font-family:'Cinzel',serif;font-size:8px;letter-spacing:.5px;color:rgba(255,255,255,.55);text-transform:uppercase;min-width:28px;flex-shrink:0}
.hbar{width:90px;height:12px;background:rgba(0,0,0,.45);border:1px solid rgba(255,255,255,.12);border-radius:6px;overflow:hidden;flex-shrink:0}
.hbar-fill{height:100%;border-radius:6px;transition:width .4s}
.hbar-fill.hp{background:linear-gradient(90deg,#c62828,#f44336,#ff8a65)}
.hbar-fill.xp{background:linear-gradient(90deg,#2e7d32,#4caf50,#a5d6a7)}
.hval{font-size:11px;color:rgba(255,255,255,.85);font-weight:700;min-width:32px;font-family:'Cinzel',serif}
.hrow[data-tip]{cursor:help;pointer-events:all}
.hrow[data-tip]:hover::after{content:attr(data-tip);position:absolute;top:calc(100% + 6px);left:0;background:rgba(5,15,2,.97);border:1px solid rgba(126,200,80,.5);border-radius:8px;padding:6px 12px;font-family:'Nunito',sans-serif;font-size:12px;font-weight:700;color:#7ec850;white-space:nowrap;z-index:200;pointer-events:none}
.hmid{flex:1;display:flex;flex-direction:column;gap:3px;min-width:0}
.hlbl{font-family:'Cinzel',serif;font-size:8px;letter-spacing:2px;color:#7ec850;text-transform:uppercase;text-shadow:0 1px 3px rgba(0,0,0,.9)}
.hpbg{width:100%;height:14px;background:rgba(0,0,0,.45);border:1px solid rgba(255,255,255,.12);border-radius:8px;overflow:hidden;position:relative}
.hpfg{height:100%;background:linear-gradient(90deg,#2e7d32,#66bb6a,#a5d6a7);border-radius:8px;transition:width .7s cubic-bezier(.34,1.56,.64,1)}
.hptxt{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-family:'Cinzel',serif;font-size:10px;font-weight:700;color:#fff;text-shadow:0 1px 3px rgba(0,0,0,.9)}
.htimer{font-family:'Cinzel',serif;font-size:15px;font-weight:700;color:#a8e060;background:rgba(0,0,0,.5);border:1px solid rgba(126,200,80,.3);border-radius:8px;padding:4px 10px;letter-spacing:1px;flex-shrink:0}
.hcurs{display:flex;gap:6px;flex-shrink:0}
.hcur{display:flex;align-items:center;gap:4px;background:rgba(0,0,0,.55);border:2px solid rgba(255,255,255,.12);border-radius:20px;padding:4px 10px;font-family:'Cinzel',serif;font-weight:700;font-size:12px}
.hcur.c{color:#ffd54f;border-color:rgba(255,213,79,.3)}
.hcur.g{color:#e879f9;border-color:rgba(232,121,249,.3)}
#toolpanel{position:absolute;right:10px;top:50%;transform:translateY(-50%);display:flex;flex-direction:column;gap:7px;z-index:50;background:rgba(4,18,2,.9);border:2px solid rgba(126,200,80,.32);border-radius:18px;padding:10px 7px;box-shadow:0 4px 24px rgba(0,0,0,.7)}
.tp-title{font-family:'Cinzel',serif;font-size:8px;letter-spacing:2px;color:rgba(126,200,80,.55);text-transform:uppercase;text-align:center;margin-bottom:3px}
.ts{width:58px;height:58px;border-radius:14px;background:rgba(255,255,255,.06);border:2px solid rgba(255,255,255,.1);display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;transition:all .18s;position:relative}
.ts:hover{background:rgba(126,200,80,.16);border-color:rgba(126,200,80,.5);transform:scale(1.06)}
.ts.on{background:rgba(126,200,80,.24);border-color:#7ec850;box-shadow:0 0 18px rgba(126,200,80,.5)}
.ts.dim{opacity:.28;cursor:not-allowed;pointer-events:none}
.ts-ico{font-size:24px;line-height:1}
.ts-nm{font-size:7px;font-weight:800;color:rgba(255,255,255,.58);text-transform:uppercase;margin-top:2px}
.ts-cnt{position:absolute;top:-5px;right:-5px;background:#7ec850;color:#0a1e04;font-size:10px;font-weight:900;border-radius:10px;padding:0 5px;font-family:'Cinzel',serif;min-width:18px;text-align:center}
.ts-tooltip{position:absolute;right:calc(100% + 14px);top:50%;transform:translateY(-50%);background:rgba(4,18,2,.97);border:2px solid rgba(126,200,80,.45);border-radius:10px;padding:8px 12px;font-family:'Nunito',sans-serif;font-size:12px;font-weight:700;color:#fff;white-space:nowrap;pointer-events:none;opacity:0;transition:opacity .18s;z-index:100;min-width:180px}
.ts-tooltip .tt-title{font-family:'Cinzel',serif;font-size:11px;font-weight:700;color:#7ec850;margin-bottom:4px}
.ts-tooltip .tt-works{font-size:11px;color:rgba(255,255,255,.75)}
.ts-tooltip .tt-tip{font-size:10px;color:rgba(180,255,180,.8);margin-top:3px;font-style:italic}
.ts:hover .ts-tooltip{opacity:1}
#mm{position:absolute;top:72px;left:10px;width:108px;height:108px;background:rgba(4,18,2,.9);border:2px solid rgba(126,200,80,.35);border-radius:10px;z-index:45;overflow:hidden}
#mmcv{width:100%;height:100%}
#lvbadge{position:absolute;top:72px;left:126px;background:rgba(4,18,2,.9);border:2px solid rgba(126,200,80,.4);border-radius:8px;padding:4px 12px;font-family:'Cinzel',serif;font-size:10px;font-weight:700;color:#7ec850;z-index:45;letter-spacing:2px}
#qpanel{position:absolute;bottom:66px;left:10px;background:rgba(4,18,2,.92);border:2px solid rgba(126,200,80,.32);border-radius:12px;padding:10px 14px;z-index:45;max-width:210px}
.qp-h{font-family:'Cinzel',serif;font-size:9px;letter-spacing:3px;color:#7ec850;text-transform:uppercase;margin-bottom:6px}
.qp-r{display:flex;align-items:center;gap:8px;margin-bottom:4px;font-size:12px;font-weight:700;color:rgba(255,255,255,.82);line-height:1.3}
.qp-r.done{color:rgba(90,200,70,.8)}
.qp-r .qi{font-size:15px;flex-shrink:0}
#wrongtool{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%) scale(0);background:rgba(8,2,2,.97);border:3px solid #e53935;border-radius:16px;padding:18px 32px;z-index:190;text-align:center;pointer-events:none;transition:transform .3s cubic-bezier(.34,1.56,.64,1);max-width:380px;width:90%}
#wrongtool.show{transform:translate(-50%,-50%) scale(1)}
#wrongtool .wt-ico{font-size:38px;display:block;margin-bottom:6px}
#wrongtool .wt-title{font-family:'Cinzel',serif;font-size:17px;font-weight:700;color:#ff5252;margin-bottom:6px}
#wrongtool .wt-msg{font-family:'Nunito',sans-serif;font-size:14px;color:rgba(255,200,200,.85);line-height:1.5}
#wrongtool .wt-suggest{font-family:'Cinzel',serif;font-size:13px;color:#7ec850;margin-top:8px;padding:6px 12px;background:rgba(126,200,80,.12);border-radius:8px;border:1px solid rgba(126,200,80,.3)}
#bbar{position:absolute;bottom:0;left:0;right:0;height:60px;display:flex;align-items:center;justify-content:space-between;padding:0 12px;z-index:50;background:linear-gradient(0deg,rgba(0,10,0,.7)0%,transparent)}
.bb{background:rgba(4,14,2,.88);border:2px solid rgba(126,200,80,.3);border-radius:9px;color:#7ec850;font-family:'Cinzel',serif;font-size:10px;letter-spacing:1px;padding:8px 14px;cursor:pointer;transition:all .2s;text-transform:uppercase;font-weight:700;pointer-events:all}
.bb:hover{border-color:#7ec850;box-shadow:0 0 10px rgba(126,200,80,.3)}
#bbhint{font-family:'Cinzel',serif;font-size:8px;letter-spacing:1px;color:rgba(126,200,80,.45);text-align:center;flex:1;text-transform:uppercase}
#spch{position:absolute;background:rgba(255,252,240,.97);border:3px solid #7ec850;border-radius:14px;padding:10px 13px;font-size:13px;font-weight:700;color:#1a3a06;max-width:185px;z-index:55;box-shadow:0 4px 16px rgba(0,0,0,.5);display:none;pointer-events:none;line-height:1.4}
#spch::after{content:'';position:absolute;bottom:-11px;left:18px;border-left:10px solid transparent;border-right:10px solid transparent;border-top:11px solid #7ec850}
#achtoast{position:fixed;top:72px;left:50%;transform:translateX(-50%) translateY(-130px);background:linear-gradient(135deg,rgba(4,18,2,.97),rgba(10,30,4,.97));border:2px solid #7ec850;border-radius:14px;padding:12px 22px;z-index:200;display:flex;align-items:center;gap:12px;transition:transform .5s cubic-bezier(.34,1.56,.64,1);pointer-events:none}
#achtoast.show{transform:translateX(-50%) translateY(0)}
.ati{font-size:32px}
.att .atn{font-family:'Cinzel',serif;font-size:13px;font-weight:700;color:#7ec850}
.att .ats{font-size:11px;color:rgba(255,255,255,.7)}
#gbanner{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%) scale(0);background:rgba(4,18,2,.96);border:3px solid #7ec850;border-radius:16px;padding:18px 40px;font-family:'Cinzel',serif;font-size:22px;font-weight:700;color:#7ec850;z-index:180;text-align:center;transition:transform .35s cubic-bezier(.34,1.56,.64,1);pointer-events:none;box-shadow:0 0 60px rgba(126,200,80,.45)}
#gbanner.show{transform:translate(-50%,-50%) scale(1)}
#modal{position:fixed;inset:0;background:rgba(0,0,0,.8);z-index:100;display:flex;align-items:center;justify-content:center;backdrop-filter:blur(8px)}
#modal.hidden{display:none}
.parch{background:radial-gradient(ellipse at 22% 14%,rgba(200,240,180,.3)0%,transparent 54%),linear-gradient(160deg,#e8f5d8 0%,#c8e8a8 38%,#a8d070 72%,#88b840 100%);border:4px solid #4a8018;border-radius:18px;box-shadow:0 30px 90px rgba(0,0,0,.9);max-width:560px;width:96%;padding:28px 36px 24px;position:relative;animation:scUp .45s cubic-bezier(.34,1.56,.64,1);color:#1a3006}
@keyframes scUp{from{transform:scale(.65) translateY(40px);opacity:0}to{transform:scale(1);opacity:1}}
.pi{position:absolute;inset:10px;border:1px solid rgba(74,128,24,.22);border-radius:12px;pointer-events:none}
.pc{position:absolute;font-size:16px;color:#4a8018;opacity:.36}
.pc.tl{top:14px;left:18px}.pc.tr{top:14px;right:18px}.pc.bl{bottom:14px;left:18px}.pc.br{bottom:14px;right:18px}
.m-tier{font-family:'Cinzel',serif;font-size:10px;letter-spacing:5px;color:#2a5c08;text-align:center;text-transform:uppercase;margin-bottom:8px}
.m-gate-card{display:flex;align-items:center;gap:14px;margin-bottom:16px;padding:12px 18px;background:rgba(74,128,24,.13);border-radius:12px;border:2px solid rgba(74,128,24,.25)}
.m-gate-ico{font-size:42px;flex-shrink:0}
.m-gate-right{flex:1}
.m-gate-name{font-family:'Cinzel',serif;font-size:15px;font-weight:700;color:#2a5c08;letter-spacing:2px}
.m-gate-tool{display:flex;align-items:center;gap:6px;margin-top:5px;padding:5px 10px;background:rgba(74,128,24,.15);border:1px solid rgba(74,128,24,.35);border-radius:8px;font-size:12px;font-weight:700;color:#1a5808}
.m-gate-skipbtn{display:flex;align-items:center;gap:8px;width:100%;margin-bottom:14px;padding:10px 16px;background:linear-gradient(180deg,rgba(60,140,20,.85),rgba(30,90,10,.85));border:2px solid #7ec850;border-radius:11px;color:#d0f0a0;cursor:pointer;font-family:'Nunito',sans-serif;font-size:15px;font-weight:800;transition:all .2s}
.m-gate-skipbtn:hover{background:linear-gradient(180deg,rgba(80,160,30,.9),rgba(40,110,15,.9));transform:scale(1.02)}
.m-gate-skipbtn .sb-ico{font-size:22px;flex-shrink:0}
.m-gate-skipbtn .sb-main{font-size:14px;font-weight:800;display:block}
.m-gate-skipbtn .sb-sub{font-size:11px;color:rgba(200,240,160,.7);display:block;margin-top:1px}
.m-sent{font-family:'Nunito',sans-serif;font-size:22px;font-weight:800;text-align:center;line-height:1.55;margin-bottom:6px}
.m-blank{display:inline-block;min-width:90px;border-bottom:3px solid #4a8018;text-align:center;color:#1a5808;padding:0 8px}
.m-basefm{font-size:13px;font-style:italic;color:#3a6010;text-align:center;margin-bottom:18px}
.m-opts{display:flex;flex-direction:column;gap:9px;margin-bottom:12px}
.m-opt{background:linear-gradient(180deg,rgba(255,255,255,.24)0%,rgba(255,255,255,.05)100%);border:2px solid rgba(74,128,24,.42);border-radius:11px;color:#1a3006;cursor:pointer;font-family:'Nunito',sans-serif;font-size:20px;font-weight:700;padding:12px 18px;text-align:left;transition:all .18s}
.m-opt .ol{display:inline-flex;align-items:center;justify-content:center;width:30px;height:30px;background:#4a8018;color:#e8f5d8;border-radius:9px;font-family:'Cinzel',serif;font-size:13px;font-weight:700;margin-right:12px;flex-shrink:0}
.m-opt:hover:not(:disabled){background:rgba(200,240,150,.45);transform:translateX(6px);border-color:#4a8018}
.m-opt.ok{background:linear-gradient(180deg,#c8f5c0,#78d560);border-color:#3a8030!important}
.m-opt.bad{background:linear-gradient(180deg,#f5c0c0,#d06060);border-color:#903030!important;animation:shk .35s}
@keyframes shk{0%,100%{transform:translateX(0)}25%,75%{transform:translateX(-9px)}50%{transform:translateX(9px)}}
.m-fb{font-family:'Cinzel',serif;font-size:12px;font-weight:700;letter-spacing:2px;text-align:center;min-height:20px}
.m-fb.ok{color:#2a7020}.m-fb.bad{color:#8a2020}
.m-stats{display:flex;justify-content:center;gap:18px;margin-top:8px}
.m-stat{font-family:'Cinzel',serif;font-size:11px;color:#3a6010;display:flex;align-items:center;gap:4px}
#lvc{position:fixed;inset:0;background:rgba(0,0,0,.84);z-index:200;display:flex;align-items:center;justify-content:center}
#lvc.hidden{display:none}
.lcc{background:linear-gradient(150deg,#0a1e04,#051202);border:3px solid #7ec850;border-radius:20px;max-width:480px;width:95%;padding:38px;text-align:center;animation:zIn .6s cubic-bezier(.34,1.56,.64,1)}
@keyframes zIn{from{transform:scale(.65);opacity:0}to{transform:scale(1);opacity:1}}
.lc-ico{font-size:62px;animation:wb 3s ease-in-out infinite alternate}
@keyframes wb{from{transform:rotate(-6deg)}to{transform:rotate(6deg)}}
.lc-t{font-family:'Cinzel',serif;font-size:28px;font-weight:900;color:#7ec850;margin:10px 0 6px}
.lc-s{font-family:'Nunito',sans-serif;font-size:15px;color:#90c880;margin-bottom:22px}
.lc-sts{display:flex;justify-content:center;gap:22px;margin-bottom:22px;flex-wrap:wrap}
.lc-sv{font-family:'Cinzel',serif;font-size:24px;font-weight:700;color:#7ec850;display:block}
.lc-sl{font-family:'Nunito',sans-serif;font-size:10px;color:#5a7850;letter-spacing:2px;text-transform:uppercase}
.lc-ah{display:flex;flex-wrap:wrap;justify-content:center;gap:7px;margin-bottom:20px}
.ab{background:rgba(126,200,80,.14);border:1px solid rgba(126,200,80,.3);border-radius:8px;padding:4px 10px;font-size:11px;color:#7ec850;font-family:'Cinzel',serif}
#ge{position:fixed;inset:0;background:rgba(0,0,0,.92);z-index:300;display:flex;align-items:center;justify-content:center}
#ge.hidden{display:none}
.gec{background:linear-gradient(150deg,#e8f5d8,#c8e8a8 40%,#a0c870 100%);border:4px solid #4a8018;border-radius:20px;max-width:560px;width:95%;padding:42px;text-align:center;color:#1a3006;animation:zIn .6s cubic-bezier(.34,1.56,.64,1);position:relative}
.gei{position:absolute;inset:10px;border:1px solid rgba(74,128,24,.22);border-radius:14px;pointer-events:none}
.ge-ico{font-size:62px;animation:wb 4s ease-in-out infinite alternate}
.ge-pre{font-family:'Cinzel',serif;font-size:9px;letter-spacing:5px;color:#4a8018;text-transform:uppercase;margin-bottom:4px}
.ge-t{font-family:'Cinzel',serif;font-size:26px;font-weight:900;color:#1a3006;margin-bottom:14px}
.ge-sts{display:flex;justify-content:center;gap:22px;margin-bottom:20px;flex-wrap:wrap}
.ge-sv{font-family:'Cinzel',serif;font-size:24px;font-weight:700;color:#4a8018;display:block}
.ge-sl{font-family:'Nunito',sans-serif;font-size:10px;color:#3a6010;letter-spacing:2px;text-transform:uppercase}
.ge-ah{display:flex;flex-wrap:wrap;justify-content:center;gap:8px;margin-bottom:18px}
#ss{position:absolute;inset:0;z-index:200;background:radial-gradient(ellipse at 50% 30%,#1a6818,#040a02 100%);display:flex;align-items:center;justify-content:center}
#ss.hidden{display:none}
.ssc{background:rgba(4,14,2,.95);border:3px solid #7ec850;border-radius:22px;padding:40px 46px;text-align:center;max-width:520px;width:95%;box-shadow:0 0 90px rgba(126,200,80,.2)}
.ss-lo{font-size:60px;animation:bob 2.5s ease-in-out infinite}
@keyframes bob{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
.ss-sub{font-family:'Cinzel',serif;font-size:10px;letter-spacing:5px;color:#3a7018;text-transform:uppercase;margin-bottom:4px}
.ss-ti{font-family:'Cinzel',serif;font-size:clamp(24px,5vw,46px);font-weight:900;color:#7ec850;text-shadow:0 0 32px rgba(126,200,80,.5);line-height:1.1;margin-bottom:6px}
.ss-tg{font-family:'Nunito',sans-serif;font-size:16px;color:#6a9850;margin-bottom:10px}
.ss-de{font-family:'Nunito',sans-serif;font-size:13px;color:#3a5838;margin-bottom:24px;line-height:1.7}
.ss-de b{color:#7ec850}
.ss-lb{font-family:'Cinzel',serif;font-size:11px;letter-spacing:3px;color:#7ec850;text-transform:uppercase;display:block;margin-bottom:8px}
.ss-in{background:rgba(255,255,255,.05);border:2px solid #2a5810;border-radius:9px;color:#c8f0a0;font-family:'Nunito',sans-serif;font-size:18px;padding:11px 18px;text-align:center;outline:none;width:100%;margin-bottom:20px;transition:border-color .3s}
.ss-in:focus{border-color:#7ec850}
.bg{background:linear-gradient(180deg,#3a7010,#1a4808 60%,#0e3004 100%);border:2px solid #7ec850;border-radius:11px;color:#c8f080;cursor:pointer;font-family:'Cinzel',serif;font-size:15px;font-weight:700;letter-spacing:3px;padding:14px 42px;text-transform:uppercase;transition:all .25s}
.bg:hover{background:linear-gradient(180deg,#4a8820,#2a5810 60%,#1a4408 100%);transform:translateY(-2px)}
.ft{position:fixed;font-family:'Cinzel',serif;font-size:22px;font-weight:700;pointer-events:none;z-index:150;animation:ftu 1.3s ease forwards;text-shadow:0 2px 8px rgba(0,0,0,.9)}
@keyframes ftu{0%{transform:translateY(0) scale(1.2);opacity:1}100%{transform:translateY(-110px) scale(.8);opacity:0}}
.ft.ok{color:#4caf50}.ft.bad{color:#e53935}.ft.coin{color:#ffd54f}.ft.tool{color:#80cfff}
.cf{position:fixed;pointer-events:none;z-index:200;animation:cff linear forwards}
@keyframes cff{0%{opacity:1;transform:translateY(-10px) rotate(0)}100%{opacity:0;transform:translateY(110vh) rotate(720deg)}}
</style>
</head>
<body>
<div id="G">
<div id="ss">
<div class="ssc">
<div class="ss-lo">üåø</div>
<div class="ss-sub">Grammar Adventure RPG</div>
<div class="ss-ti">Maze of Verbs</div>
<div class="ss-tg">Hedge Garden ‚Äî Irregular Verbs Quest</div>
<div class="ss-de">
üß≠ Walk through the <b>round hedge maze</b> as an explorer<br>
üîí Gates <b>block corridors</b> ‚Äî answer grammar questions to pass<br>
üéØ Reach the <b>red X</b> in the center to win!<br>
‚û°Ô∏è <b>Yellow arrows</b> always show you the way!
</div>
<label class="ss-lb">Your Explorer's Name</label>
<input class="ss-in" id="nameIn" type="text" placeholder="Enter your name‚Ä¶" maxlength="22" autocomplete="off">
<button class="bg" id="startBtn">üåø Enter the Maze</button>
</div>
</div>
<canvas id="gc"></canvas>
<div id="hud">
<div class="av" title="Your hero">üß≠<div class="av-lv" id="avLv">1</div></div>
<div class="hstat">
<div class="hrow" data-tip="‚ù§Ô∏è HP ‚Äî Lives remaining">
<span class="hlabel">‚ù§Ô∏è HP</span>
<div class="hbar"><div class="hbar-fill hp" id="hpBar" style="width:100%"></div></div>
<span class="hval" id="hpVal">3/3</span>
</div>
<div class="hrow" data-tip="‚≠ê XP ‚Äî Experience points">
<span class="hlabel">‚≠ê XP</span>
<div class="hbar"><div class="hbar-fill xp" id="xpBar" style="width:0%"></div></div>
<span class="hval" id="xpVal">0/100</span>
</div>
</div>
<div class="hmid">
<div class="hlbl" id="progLbl">Level 1 ‚Äî Open all gates!</div>
<div class="hpbg"><div class="hpfg" id="progFg" style="width:0%"></div><div class="hptxt" id="progTxt">0/6 gates</div></div>
</div>
<div class="htimer" id="timer">00:00</div>
<div class="hcurs">
<div class="hcur g"><span>üíé</span><span id="gemC">5</span></div>
<div class="hcur c"><span>ü™ô</span><span id="coinC">100</span></div>
</div>
</div>
<div id="lvbadge">LEVEL <span id="lvNum">1</span></div>
<div id="mm"><canvas id="mmcv" width="108" height="108"></canvas></div>
<div id="qpanel">
<div class="qp-h">üìã Quest</div>
<div class="qp-r" id="qr1"><span class="qi">üîí</span><span id="qr1t">Open all gates</span></div>
<div class="qp-r" id="qr2"><span class="qi">‚ùå</span><span id="qr2t">Reach the red X center!</span></div>
</div>
<div id="toolpanel">
<div class="tp-title">TOOLS</div>
<div class="ts on" id="t0"><div class="ts-ico">üë£</div><div class="ts-nm">Walk</div>
<div class="ts-tooltip"><div class="tt-title">Walk Mode</div><div class="tt-works">Click anywhere to move</div><div class="tt-tip">Click a gate to answer</div></div>
</div>
<div class="ts" id="t1"><div class="ts-ico">ü™ì</div><div class="ts-nm">Axe</div><span class="ts-cnt" id="tc1">3</span>
<div class="ts-tooltip"><div class="tt-title">ü™ì Axe</div><div class="tt-works">Works on: üåø Vine Gates</div><div class="tt-tip">Chop through hedges!</div></div>
</div>
<div class="ts" id="t2"><div class="ts-ico">‚õèÔ∏è</div><div class="ts-nm">Pick</div><span class="ts-cnt" id="tc2">2</span>
<div class="ts-tooltip"><div class="tt-title">‚õèÔ∏è Pickaxe</div><div class="tt-works">Works on: ‚õ©Ô∏è Stone, üéã Bamboo</div><div class="tt-tip">Break stone barriers!</div></div>
</div>
<div class="ts" id="t3"><div class="ts-ico">üóùÔ∏è</div><div class="ts-nm">Key</div><span class="ts-cnt" id="tc3">1</span>
<div class="ts-tooltip"><div class="tt-title">üóùÔ∏è Magic Key</div><div class="tt-works">Works on: üîÆ Rune Doors</div><div class="tt-tip">Unlock magical gates!</div></div>
</div>
<div class="ts" id="t4"><div class="ts-ico">‚ú®</div><div class="ts-nm">Magic</div><span class="ts-cnt" id="tc4">1</span>
<div class="ts-tooltip"><div class="tt-title">‚ú® Magic Scroll</div><div class="tt-works">Works on: ALL gate types!</div><div class="tt-tip">Instant clear!</div></div>
</div>
</div>
<div id="bbar">
<button class="bb" id="hintBtn">üí° Hint (‚àí5ü™ô)</button>
<div id="bbhint">Click to walk ¬∑ Click gates to answer ¬∑ Find the red X!</div>
<button class="bb" id="pauseBtn">‚è∏ Pause</button>
</div>
<div id="spch"></div>
<div id="achtoast"><div class="ati" id="ati">üèÜ</div><div class="att"><div class="atn" id="atn">Achievement!</div><div class="ats" id="ats">Unlocked</div></div></div>
<div id="gbanner">üîì Gate Opened!</div>
<div id="wrongtool">
<span class="wt-ico" id="wt-ico">‚ùå</span>
<div class="wt-title" id="wt-title">Wrong Tool!</div>
<div class="wt-msg" id="wt-msg">That tool won't work here.</div>
<div class="wt-suggest" id="wt-suggest">Use ü™ì Axe instead!</div>
</div>
<div id="modal" class="hidden">
<div class="parch">
<div class="pi"></div>
<span class="pc tl">üåø</span><span class="pc tr">üå∫</span><span class="pc bl">üçÉ</span><span class="pc br">üå∏</span>
<div class="m-tier" id="mTier">Common Verbs ‚Äî Tier I</div>
<div class="m-gate-card">
<div class="m-gate-ico" id="mGIco">üåø</div>
<div class="m-gate-right">
<div class="m-gate-name" id="mGName">HEDGE GATE</div>
<div class="m-gate-tool"><span class="tool-ico" id="mToolIco">ü™ì</span><span id="mToolMsg">Or use Axe to skip</span></div>
</div>
</div>
<button class="m-gate-skipbtn hidden" id="mSkipBtn">
<span class="sb-ico" id="mSkipIco">ü™ì</span>
<span class="sb-txt"><span class="sb-main" id="mSkipMain">Use Axe to chop this gate!</span><span class="sb-sub" id="mSkipSub">3 uses remaining</span></span>
</button>
<div class="m-sent" id="mSent"></div>
<div class="m-basefm" id="mBase">Base form: "go"</div>
<div class="m-opts" id="mOpts"></div>
<div class="m-fb" id="mFb"></div>
<div class="m-stats">
<div class="m-stat">üéØ Streak: <span id="mStr">0</span></div>
<div class="m-stat">‚úÖ Accuracy: <span id="mAcc">‚Äî</span></div>
<div class="m-stat">ü™ô +10 on correct</div>
</div>
</div>
</div>
<div id="lvc" class="hidden">
<div class="lcc">
<div class="lc-ico">üéä</div>
<div class="lc-t" id="lcT">Maze Cleared!</div>
<div class="lc-s" id="lcS">You reached the center!</div>
<div class="lc-sts">
<div><span class="lc-sv" id="lcSc">0</span><span class="lc-sl">Score</span></div>
<div><span class="lc-sv" id="lcAc">100%</span><span class="lc-sl">Accuracy</span></div>
<div><span class="lc-sv" id="lcTm">0:00</span><span class="lc-sl">Time</span></div>
<div><span class="lc-sv" id="lcRw">+50ü™ô</span><span class="lc-sl">Reward</span></div>
</div>
<div class="lc-ah" id="lcAh"></div>
<button class="bg" id="nextBtn">Next Level ‚ñ∂</button>
</div>
</div>
<div id="ge" class="hidden">
<div class="gec"><div class="gei"></div>
<div class="ge-ico">üèÜ</div>
<div class="ge-pre">Certificate of Mastery</div>
<div class="ge-t" id="geT">Maze Champion!</div>
<div class="ge-sts">
<div><span class="ge-sv" id="geSc">0</span><span class="ge-sl">Score</span></div>
<div><span class="ge-sv" id="geAc">0%</span><span class="ge-sl">Accuracy</span></div>
<div><span class="ge-sv" id="geTm">0:00</span><span class="ge-sl">Time</span></div>
<div><span class="ge-sv" id="geLv">1</span><span class="ge-sl">Levels</span></div>
</div>
<div class="ge-ah" id="geAh"></div>
<button class="bg" id="replayBtn">üîÑ Play Again</button>
</div>
</div>
<script>
(()=>{
'use strict';

// ==========================================
// CUSTOM GATE IMAGE CONFIGURATION
// ==========================================
// 1. Convert your image to Base64 (use a site like base64-image.de)
// 2. Paste the code inside the quotes below.
const CUSTOM_GATE_SRC = ""; // –í–°–¢–ê–í–¨–¢–ï –°–Æ–î–ê –í–ê–® –ö–û–î BASE64
// ==========================================

const VERBS=[
{b:'go',p:'went',d:['goed','gone'],t:1},{b:'take',p:'took',d:['taked','tooked'],t:1},
{b:'see',p:'saw',d:['seed','seen'],t:1},{b:'come',p:'came',d:['comed','come'],t:1},
{b:'get',p:'got',d:['getted','gotten'],t:1},{b:'make',p:'made',d:['maked','maed'],t:1},
{b:'know',p:'knew',d:['knowed','known'],t:1},{b:'think',p:'thought',d:['thinked','thunk'],t:1},
{b:'say',p:'said',d:['sayed','sed'],t:1},{b:'give',p:'gave',d:['gived','gaven'],t:1},
{b:'find',p:'found',d:['finded','founded'],t:1},{b:'tell',p:'told',d:['telled','tolded'],t:1},
{b:'write',p:'wrote',d:['writed','written'],t:2},{b:'break',p:'broke',d:['breaked','broked'],t:2},
{b:'speak',p:'spoke',d:['speaked','spoken'],t:2},{b:'drive',p:'drove',d:['drived','driven'],t:2},
{b:'choose',p:'chose',d:['choosed','chosen'],t:2},{b:'steal',p:'stole',d:['stealed','stolen'],t:2},
{b:'wear',p:'wore',d:['weared','worn'],t:2},{b:'forget',p:'forgot',d:['forgetted','forgotten'],t:2},
{b:'begin',p:'began',d:['beginned','begun'],t:2},{b:'swim',p:'swam',d:['swimmed','swum'],t:2},
{b:'seek',p:'sought',d:['seeked','sook'],t:3},{b:'flee',p:'fled',d:['fleed','flied'],t:3},
{b:'bind',p:'bound',d:['binded','bounden'],t:3},{b:'weave',p:'wove',d:['weaved','woven'],t:3},
{b:'slay',p:'slew',d:['slayed','slain'],t:3},{b:'awake',p:'awoke',d:['awaked','awaken'],t:3},
{b:'shine',p:'shone',d:['shined','shon'],t:3},{b:'deal',p:'dealt',d:['dealed','dealt'],t:3},
];
const SENTS=[
'Yesterday our explorer ______ through the hedge maze.',
'The ancient wizard ______ a powerful spell.',
'She bravely ______ the secret chamber.',
'He ______ through the dark green corridor.',
'They ______ the hidden passage at night.',
'The explorer ______ a strange artifact.',
'She ______ the answer to the ancient riddle.',
'He ______ deep into the garden labyrinth.',
'The guardian ______ into the shadows.',
'The brave knight ______ the path to the center.',
'She ______ about the danger and escaped.',
'Our guide ______ us through the maze.',
];
const TIER_LBL={1:'Common Verbs ‚Äî Tier I',2:'Intermediate ‚Äî Tier II',3:'Advanced ‚Äî Tier III'};
const GATE_DATA={
iron_gate:{nm:'STONE GATE',ic:'‚õ©Ô∏è',tool:'t2',toolIco:'‚õèÔ∏è',toolNm:'Pickaxe',msg:'Use ‚õèÔ∏è Pickaxe to smash it!'},
vine_gate:{nm:'HEDGE GATE',ic:'üåø',tool:'t1',toolIco:'ü™ì',toolNm:'Axe',msg:'Use ü™ì Axe to chop it!'},
rune_door:{nm:'RUNE DOOR',ic:'üîÆ',tool:'t3',toolIco:'üóùÔ∏è',toolNm:'Key',msg:'Use üóùÔ∏è Key to unlock!'},
spike_gate:{nm:'THORN WALL',ic:'üåµ',tool:'t2',toolIco:'‚õèÔ∏è',toolNm:'Pickaxe',msg:'Use ‚õèÔ∏è Pickaxe to break!'},
};
const TOOL_COMPAT={t1:['vine_gate'],t2:['iron_gate','spike_gate'],t3:['rune_door'],t4:['iron_gate','vine_gate','rune_door','spike_gate']};
const TOOL_ICO={t1:'ü™ì',t2:'‚õèÔ∏è',t3:'üóùÔ∏è',t4:'‚ú®'};
const WRONG_MSGS={
t1:{iron_gate:'ü™ì Axe can\'t break stone! Use ‚õèÔ∏è Pickaxe.',vine_gate:null,rune_door:'ü™ì Axe can\'t break runes! Use üóùÔ∏è Key.',spike_gate:'ü™ì Axe won\'t work! Use ‚õèÔ∏è Pickaxe.'},
t2:{iron_gate:null,vine_gate:'‚õèÔ∏è Pickaxe can\'t cut hedges! Use ü™ì Axe.',rune_door:'‚õèÔ∏è Pickaxe won\'t work on magic! Use üóùÔ∏è Key.',spike_gate:null},
t3:{iron_gate:'üóùÔ∏è Key can\'t open stone! Use ‚õèÔ∏è Pickaxe.',vine_gate:'üóùÔ∏è Key won\'t cut hedges! Use ü™ì Axe.',rune_door:null,spike_gate:'üóùÔ∏è Key can\'t break thorns! Use ‚õèÔ∏è Pickaxe.'},
};
const NPC_LINES=[
['Follow the yellow arrows!','The red X is in the center!','Open all gates first!'],
['Answer correctly ‚Äî gates open!','Use tools as shortcuts!','Watch the flashing gates!'],
['Woof! Follow me! üêï','*sniffs* This way!','Bark! Gate over there!'],
['Right tool = instant open!','Magic works on everything!','Need a key? Check tools!'],
];
const ACHS=[
{id:'a1',nm:'Gate Breaker',ds:'Open your first gate',ic:'üîì',fn:s=>s.cl>=1},
{id:'a2',nm:'Sharpshooter',ds:'5 correct answers in a row',ic:'üéØ',fn:s=>s.str>=5},
{id:'a3',nm:'Handyman',ds:'Use a tool on a gate',ic:'ü™ì',fn:s=>s.tu>=1},
{id:'a4',nm:'Trailblazer',ds:'Clear 10 gates total',ic:'üó∫Ô∏è',fn:s=>s.tc>=10},
{id:'a5',nm:'Scholar',ds:'20 correct answers',ic:'üìö',fn:s=>s.cor>=20},
{id:'a6',nm:'Pathfinder',ds:'Complete Level 1',ic:'üèÅ',fn:s=>s.lvc>=1},
{id:'a7',nm:'Untouchable',ds:'Level with no HP loss',ic:'üõ°Ô∏è',fn:s=>s.hloss===0},
{id:'a8',nm:'Speedster',ds:'Clear level under 90s',ic:'‚ö°',fn:s=>s.lt<90},
{id:'a9',nm:'Perfectionist',ds:'100% accuracy in a level',ic:'üíé',fn:s=>s.lacc>=100},
];
const CV=document.getElementById('gc');const CX=CV.getContext('2d');
const MC=document.getElementById('mmcv');const MX=MC.getContext('2d');
const COLS=19,ROWS=15;
const TW=100,TH=50,WH=72;
let W=0,H=0,OX=0,OY=0,SC=1;
let camX=0,camY=0,ctX=0,ctY=0;
// Centre of the circular maze
const CX_MAZE=9,CY_MAZE=7;
// Exit is at the very centre
let exitPos={col:CX_MAZE,row:CY_MAZE};
function resize(){
W=CV.width=window.innerWidth;H=CV.height=window.innerHeight;
const mW=(COLS+ROWS)*TW/2,mH=(COLS+ROWS)*TH/2+WH+20;
SC=Math.min(W*.60/mW,(H-66)*.63/mH,1.2);
OX=W/2;
OY=H*0.50-(CX_MAZE+CY_MAZE)*TH/2*SC;
}
function iso(c,r){return{x:OX+(c-r)*TW/2*SC-camX,y:OY+(c+r)*TH/2*SC-camY};}
function s2g(sx,sy){
const wx=sx+camX-OX,wy=sy+camY-OY;
return{col:Math.round((wx/(TW/2*SC)+wy/(TH/2*SC))/2),row:Math.round((wy/(TH/2*SC)-wx/(TW/2*SC))/2)};
}
let maze=[],gates=[],npcs=[],decors=[];
let verbQ=[],pPos={col:1,row:1};
let playerName='Explorer';
let score=0,hp=3,mhp=3,xp=0,lvl=1,coins=100,gems=5;
let totAns=0,corrAns=0,clrObs=0,totGates=6;
let active=false,inModal=false,paused=false;
let elapsed=0,timerID=null,curLvl=1,lastTs=0;
let facing=1,walkT=0;
let mPath=[],mTimer=0;const MDUR=0.16;
let curGate=null,curVerb=null;
let parts=[],gHits=[],nHits=[];
let opening=[];let arrowPath=[];const TOTAL_LVL=5;
let ST={cl:0,str:0,tu:0,tc:0,cor:0,lvc:0,hloss:0,lt:0,lacc:0};
let achDone=new Set();let lvlTs=0,lvlTot=0,lvlCorr=0;
const STOCK={t1:3,t2:2,t3:1,t4:1};
let curTool='t0';

// Load Custom Gate Image
let CUSTOM_GATE_IMG = null;
if(CUSTOM_GATE_SRC && CUSTOM_GATE_SRC.length > 50) {
    CUSTOM_GATE_IMG = new Image();
    CUSTOM_GATE_IMG.src = CUSTOM_GATE_SRC;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CIRCULAR MAZE BUILD
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function inCircle(c,r){
const dx=(c-CX_MAZE)/8.5,dy=(r-CY_MAZE)/6.2;
return dx*dx+dy*dy<=1.0;
}
function shuf(a){const b=[...a];for(let i=b.length-1;i>0;i--){const j=0|Math.random()*(i+1);[b[i],b[j]]=[b[j],b[i]];}return b;}
function buildMaze(){
// Start with all walls
maze=Array.from({length:ROWS},(_,r)=>Array.from({length:COLS},(_,c)=>inCircle(c,r)?1:2));
// 2 = outside circle (invisible), 1 = wall inside circle, 0 = floor path
// Recursive backtracker only inside circle
function carve(r,c){
maze[r][c]=0;
for(const[dr,dc]of shuf([[0,2],[0,-2],[2,0],[-2,0]])){
const nr=r+dr,nc=c+dc;
if(nr>=0&&nr<ROWS&&nc>=0&&nc<COLS&&inCircle(nc,nr)&&maze[nr][nc]===1){
maze[r+dr/2][c+dc/2]=0;
carve(nr,nc);
}
}
}
// Start from near edge on left
const startR=CY_MAZE,startC=1;
maze[startR][startC]=0;
carve(startR,startC);
// Extra openings for more paths (richer maze)
for(let i=0;i<18;i++){
const r=1+Math.floor(Math.random()*(ROWS-2));
const c=1+Math.floor(Math.random()*(COLS-2));
if(inCircle(c,r))maze[r][c]=0;
}
// Center always open (2x2)
for(let dr=-1;dr<=1;dr++)for(let dc=-1;dc<=1;dc++){
if(inCircle(CX_MAZE+dc,CY_MAZE+dr))maze[CY_MAZE+dr][CX_MAZE+dc]=0;
}
// Start position always open
maze[CY_MAZE][1]=0;maze[CY_MAZE][2]=0;maze[CY_MAZE-1][1]=0;
pPos={col:1,row:CY_MAZE};
}
function openCells(excl=[]){
const out=[];
for(let r=0;r<ROWS;r++)for(let c=0;c<COLS;c++){
if(maze[r][c]===0
&&!(r===CY_MAZE&&c<=2)
&&!(r===exitPos.row&&c===exitPos.col)
&&!excl.find(e=>e.row===r&&e.col===c))
out.push({row:r,col:c});
}
return out;
}
function bfs(sc,sr,ec,er,thru=false){
if(sc===ec&&sr===er)return[];
const key=(c,r)=>c+','+r,q=[{c:sc,r:sr,p:[]}],vis=new Set([key(sc,sr)]);
while(q.length){
const{c,r,p}=q.shift();
for(const[dc,dr]of[[0,-1],[0,1],[-1,0],[1,0]]){
const nc=c+dc,nr=r+dr;
if(nc<0||nr<0||nc>=COLS||nr>=ROWS||vis.has(key(nc,nr)))continue;
if(maze[nr][nc]===1||maze[nr][nc]===2)continue;
const gh=!thru&&gates.find(g=>g.col===nc&&g.row===nr&&!g.clr);
const np=[...p,{col:nc,row:nr}];
if(nc===ec&&nr===er)return np;
if(gh)continue;
vis.add(key(nc,nr));q.push({c:nc,r:nr,p:np});
}
}
return null;
}
function updArrows(){
const rem=gates.filter(g=>!g.clr);
if(!rem.length){arrowPath=bfs(pPos.col,pPos.row,exitPos.col,exitPos.row,true)||[];}
else{
let best=null,bd=9999;
rem.forEach(g=>{const d=Math.abs(g.col-pPos.col)+Math.abs(g.row-pPos.row);if(d<bd){bd=d;best=g;}});
arrowPath=best?bfs(pPos.col,pPos.row,best.col,best.row,true)||[]:[];
}
updQuest();
}
function updQuest(){
const rem=gates.filter(g=>!g.clr).length;
const r1=document.getElementById('qr1'),r2=document.getElementById('qr2');
const r1t=document.getElementById('qr1t'),r2t=document.getElementById('qr2t');
if(!rem){r1.className='qp-r done';r1t.textContent='All gates open! ‚úÖ';}
else{r1.className='qp-r';r1t.textContent=`Open ${rem} more gate${rem>1?'s':''}‚Ä¶`;}
if(!rem){r2.className='qp-r';r2t.textContent='‚Üí Go to red X center!';}
else{r2.className='qp-r';r2t.textContent='Exit locked until all gates open';}
}
function setupLevel(){
exitPos={col:CX_MAZE,row:CY_MAZE};
buildMaze();
const gcnt=Math.min(4+curLvl*2,12);totGates=gcnt;clrObs=0;
const cells=shuf(openCells());let used=[];
gates=[];
const gTypes=['iron_gate','vine_gate','rune_door','spike_gate'];
cells.slice(0,gcnt).forEach((p,i)=>{gates.push({...p,clr:false,type:gTypes[i%4],oa:0});used.push(p);});
npcs=[];
shuf(cells).filter(p=>!used.find(u=>u.row===p.row&&u.col===p.col)).slice(0,Math.min(2,curLvl)).forEach((p,i)=>{
npcs.push({...p,type:['old_man','child','dog','merchant'][i%4],ms:i%4});used.push(p);
});
decors=[];
const dT=['flower','mushroom','flower','rock','flower','mushroom'];
shuf(cells).filter(p=>!used.find(u=>u.row===p.row&&u.col===p.col)).slice(0,10+curLvl).forEach((p,i)=>{
decors.push({...p,type:dT[i%6]});
});
verbQ=shuf([...VERBS]);mPath=[];opening=[];
ST.hloss=0;ST.lacc=0;lvlTs=elapsed;lvlTot=0;lvlCorr=0;
updArrows();
}
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// BACKGROUND ‚Äî jungle + maze (black removed via pixels)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let _bgImg=null,_mazeImg=null,_mazeCanvas=null,_heroImg=null,_heroCanvas=null;
// Remove black background from an image ‚Üí returns canvas with transparent bg
function removeBlackBg(img,threshold=40){
const oc=document.createElement('canvas');
oc.width=img.naturalWidth;oc.height=img.naturalHeight;
const ox=oc.getContext('2d');
ox.drawImage(img,0,0);
const id=ox.getImageData(0,0,oc.width,oc.height);
const d=id.data;
for(let i=0;i<d.length;i+=4){
const r=d[i],g=d[i+1],b=d[i+2];
// If pixel is near-black ‚Üí make transparent
if(r<threshold&&g<threshold&&b<threshold){
d[i+3]=0;
} else {
// Smooth edge: partial transparency for dark pixels
const darkness=Math.max(0,threshold-(r+g+b)/3);
if(darkness>0) d[i+3]=Math.round(255*(1-darkness/threshold));
}
}
ox.putImageData(id,0,0);
return oc;
}
function _initImages(){
if(!_bgImg){
_bgImg=new Image();
_bgImg.src='data:image/png;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/4gHYSUNDX1BST0ZJTEUAAQEAAAHIAAAAAAQwAABtbnRyUkdCIFhZWiAH4AABAAEAAAAAAABhY3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlkZXNjAAAA8AAAACRyWFlaAAABFAAAABRnWFlaAAABKAAAABRiWFlaAAABPAAAABR3dHB0AAABUAAAABRyVFJDAAABZAAAAChnVFJDAAABZAAAAChiVFJDAAABZAAAAChjcHJ0AAABjAAAADxtbHVjAAAAAAAAAAEAAAAMZW5VUwAAAAgAAAAcAHMAUgBHAEJYWVogAAAAAAAAb6IAADj1AAADkFhZWiAAAAAAAABimQAAt4UAABjaWFlaIAAAAAAAACSgAAAPhAAAts9YWVogAAAAAAAA9tYAAQAAAADTLXBhcmEAAAAAAAQAAAACZmYAAPKnAAANWQAAE9AAAApbAAAAAAAAAABtbHVjAAAAAAAAAAEAAAAMZW5VUwAAACAAAAAcAEcAbwBvAGcAbABlACAASQBuAGMALgAgADIAMAAxADb/2wBDAAUDBAQEAwUEBAQFBQUGBwwIBwcHBw8LCwkMEQ8SEhEPERETFhwXExQaFRERGCEYGh0dHx8fExciJCIeJBweHx7/2wBDAQUFBQcGBw4ICA4eFBEUHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh7/wAARCAU1B9ADASIAAhEBAxEB/8QAHQAAAQUBAQEBAAAAAAAAAAAAAQACAwQFBgcICf/EAE4QAAEEAQIEBAMGBAQEBAQBDQEAAgMRBBIhBTFBUQYTImEycYEHFEJSkaEjscHRFTNickOC4fAIJFOSFjRj8SVzg6IXRFSTssLSNYTi/8QAGwEAAgMBAQEAAAAAAAAAAAAAAAECAwQFBgf/xABBEQACAgEDAwIDBwMEAgEDAQkAAQIRAwQSIQUxQRNRImFxBhQygZGhscHR8BUjQuEzUvEWJGIHQ4KScqI0RFPC/9oADAMBAAIRAxEAPwD6+Deqe1qDQnhWNmCKHNCd80AEVA0JUBJJJACSSRTGJJFJAxIIpIACWyKVJABBFJAgJUkkgBIIpJiAkkkkISSSNIASCJTSmDEihaBSQQsdacEwKQIJRAkiQlSRJoCSSSAEkkkgBJJJJgEJIJFAXQidlFIU5x2UTypRRRklYxxTbScUwlXJGVsdaVplpA7p0RskCc0qMFOCi0SiTNKcFECpAVW0XxYaQICNpdVEnQKTmhIBPAQ2SjEQCcgkolqCU1zbTkimmDVorvaoXhW3i1BK1WRkZMkKKMzAbVGZtLTlCoZI5rbiZzssUUJCq8pViZU5it0FZhmQSvVOZ9hSzO5qpK5bIRMeSRDM+lh8Wk1Ai1p5smlhdbklkZMkKKMzAbVGZtLTlCoZI5rbiZzssUUJCq8pViZU5it0FZhmQSvVOZ9hSzO5qpK5bIRMeSRDM+lh8Wk1Ai1p5smlhdbklkZMkKKMzAbVGZtLTlCoZI5rbiZzssUUJCq8pViZU5it0FZhmQSvVOZ9hSzO5qpK5bIRMeSRDM+lh8Wk1Ai1p5smlhdbklkZMkKKMzAbVGZtLTlCoZI5rbiZzssUUJCq8pViZU5it0FZhmQSvVOZ9hSzO5qpK5bIRMeSRDM+lh8Wk1Ai1p5smlhdbklkZMkKKMzAbVGZtLTlCoZI5rbiZzssUUJCq8pViZU5it0FZhmQSvVOZ9hSzO5qpK5bIRMeSRDM+lh8Wk1Ai1p5smlhdbklkZMkKKMzAbVGZtLTlCoZI5rbiZzssUUJCq8pViZU5it0FZhmQSvVOZ9hSzO5qpK5bIRMeSRDM+lh8Wk1
